(window.webpackJsonp=window.webpackJsonp||[]).push([[238],{1503:function(s,e,t){"use strict";t.r(e);var r=t(10),o=Object(r.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"proxy-subscriptions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#proxy-subscriptions"}},[s._v("#")]),s._v(" Proxy subscriptions")]),s._v(" "),t("p",[s._v("The proxy subscription function of EMQX Broker allows the client to automatically establish the user's preset subscription relationship without sending additional SUBSCRIBE packets when the connection is established.")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),t("p",[s._v("You can use the Http API to subscribe and unsubscribe to connected devices, see "),t("RouterLink",{attrs:{to:"/en/enterprise/latest/advanced/http-api.html#endpoint-subscribe"}},[s._v("topic subscription")]),s._v(" and  "),t("RouterLink",{attrs:{to:"/en/enterprise/latest/advanced/http-api.html#endpoint-do-unsubscribe"}},[s._v("topic unscription")])],1)]),s._v(" "),t("h2",{attrs:{id:"built-in-proxy-subscription"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#built-in-proxy-subscription"}},[s._v("#")]),s._v(" Built-in proxy subscription")]),s._v(" "),t("p",[s._v("Through the built-in proxy subscription module, you can specify proxy subscription rules through the configuration file to achieve proxy subscription, which is suitable for regular and static proxy subscription requirements.")]),s._v(" "),t("h3",{attrs:{id:"enable-proxy-subscription-function"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#enable-proxy-subscription-function"}},[s._v("#")]),s._v(" Enable proxy subscription function")]),s._v(" "),t("p",[s._v("The proxy subscription function is disabled by default. To enable this function, you need to modify the "),t("code",[s._v("module.subscription")]),s._v(" configuration item in the "),t("code",[s._v("etc/emqx.conf")]),s._v(" file. The default "),t("code",[s._v("off")]),s._v(" means disabled. If you want to enable it, please change it to "),t("code",[s._v("on")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("module.subscription "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"configure-proxy-subscription-rules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#configure-proxy-subscription-rules"}},[s._v("#")]),s._v(" Configure proxy subscription rules")]),s._v(" "),t("p",[s._v("Of course, just enabling does not mean that the proxy subscription has already worked. You need to configure the corresponding rules. The proxy subscription rules of EMQX Broker support users to configure by themselves. The user can add multiple proxy subscription rules and each rule should specify the Topic and QoS. There is no limit for the number of rules. The format of proxy subscription rules is as follows:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("module.subscription."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("topic"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\nmodule.subscription."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("number"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".qos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("qos"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("When configuring the topic of proxy subscription, EMQX Broker provides two placeholders of  "),t("code",[s._v("%c")]),s._v(" and "),t("code",[s._v("%u")]),s._v(" for users to use, and EMQX Broker will replace the "),t("code",[s._v("%c")]),s._v(" and "),t("code",[s._v("%u")]),s._v(" in the configuration with the client's "),t("code",[s._v("Client ID")]),s._v(" and "),t("code",[s._v("Username")]),s._v(" respectively when performing proxy subscription. It should be noted that "),t("code",[s._v("%c")]),s._v(" and "),t("code",[s._v("%u")]),s._v(" must occupy an entire topic level.")]),s._v(" "),t("p",[s._v("For example, the following proxy subscription rules are added in the  "),t("code",[s._v("etc/emqx.conf")]),s._v("  file:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("module.subscription.1.topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" client/%c\nmodule.subscription.1.qos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nmodule.subscription.2.topic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user/%u\nmodule.subscription.2.qos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("When a client connects to EMQX Broker, if the client's "),t("code",[s._v("Client ID")]),s._v(" is "),t("code",[s._v("testclient")]),s._v(" and "),t("code",[s._v("Username")]),s._v(" is "),t("code",[s._v("tester")]),s._v(", according to the configuration rules above, the proxy subscription function will actively help the client subscribe to the topics of "),t("code",[s._v("client/testclient")]),s._v("(QoS is 1) and "),t("code",[s._v("user/tester")]),s._v("( QoS is 2)")]),s._v(" "),t("h2",{attrs:{id:"dynamic-proxy-subscription"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dynamic-proxy-subscription"}},[s._v("#")]),s._v(" Dynamic proxy subscription")]),s._v(" "),t("p",[s._v("The EMQX Enterprise version supports dynamic proxy subscription. The external database is used to set the topic list and the list is read when the device is connected to realize the proxy subscription.")])])}),[],!1,null,null,null);e.default=o.exports}}]);