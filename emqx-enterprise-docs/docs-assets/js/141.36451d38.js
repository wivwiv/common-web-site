(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{1588:function(s,n,t){"use strict";t.r(n);var a=t(10),e=Object(a.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"online-and-offline-notification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#online-and-offline-notification"}},[s._v("#")]),s._v(" Online and Offline notification")]),s._v(" "),a("p",[s._v("EMQX online and offline system message notification function automatically sends a system topic message when the client connection is successful or the client is disconnected, and EMQX turns on the online and offline notification module by default.")]),s._v(" "),a("h2",{attrs:{id:"create-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-module"}},[s._v("#")]),s._v(" Create module")]),s._v(" "),a("p",[s._v("The online and offline notification module is started by default and can be started and stopped through the dashboard page.")]),s._v(" "),a("p",[s._v("Open "),a("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("EMQX Dashboard"),a("OutboundLink")],1),s._v(', click the "Modules" tab on the left:')]),s._v(" "),a("p",[a("img",{attrs:{src:t(391),alt:"image-20200927213049265"}})]),s._v(" "),a("p",[s._v("Select the online and offline notification module")]),s._v(" "),a("p",[a("img",{attrs:{src:t(620),alt:"image-20200927213049265"}})]),s._v(" "),a("p",[s._v("There is no need to configure any parameters for the online and offline notification. After you click Add directly, the module is added.")]),s._v(" "),a("p",[a("img",{attrs:{src:t(621),alt:"image-20200927213049265"}})]),s._v(" "),a("h2",{attrs:{id:"online-and-offline-message-notification-format"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#online-and-offline-message-notification-format"}},[s._v("#")]),s._v(" Online and offline message notification format")]),s._v(" "),a("p",[a("code",[s._v("$SYS")]),s._v(" Subject prefix: "),a("code",[s._v("$SYS/brokers/${node}/clients/")])]),s._v(" "),a("p",[s._v("| Topic | Description |\n| ------------------------ | ------------------------ ---------------- |\n| ${clientid}/connected | Online event. When any client goes online, EMQX will publish a message on that topic |\n| ${clientid}/disconnected | Offline event. When any client goes offline, EMQX will publish a message on that topic |")]),s._v(" "),a("p",[s._v("The Payload of the "),a("code",[s._v("connected")]),s._v(" event message is parsed into JSON format as follows:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1625572213873")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sockport"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1883")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto_ver"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto_name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MQTT"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keepalive"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ipaddress"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"expiry_interval"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"connected_at"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1625572213873")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"connack"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clientid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqtt-8348fe27a87976ad4db3"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clean_start"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("The Payload of the "),a("code",[s._v("disconnected")]),s._v(" event message is parsed into JSON format as follows:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"foo"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1625572213873")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sockport"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1883")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reason"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tcp_closed"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto_ver"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"proto_name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MQTT"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ipaddress"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"disconnected_at"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1625572213873")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clientid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqtt-8348fe27a87976ad4db3"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports},391:function(s,n,t){s.exports=t.p+"docs-assets/img/modules.1814040c.png"},620:function(s,n,t){s.exports=t.p+"docs-assets/img/mod_presence1.7714bdbc.png"},621:function(s,n,t){s.exports=t.p+"docs-assets/img/mod_presence2.fef01d89.png"}}]);