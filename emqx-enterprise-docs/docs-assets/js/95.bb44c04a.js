(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{1718:function(s,a,t){"use strict";t.r(a);var n=t(10),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"mqtt-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-桥接"}},[s._v("#")]),s._v(" MQTT 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 MQTT Broker，支持桥接至常见 MQTT 云服务:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(415),alt:"image"}})]),s._v(" "),n("p",[s._v("mqtt bridge 桥接插件配置文件: etc/plugins/emqx_bridge_mqtt.conf。")]),s._v(" "),n("h3",{attrs:{id:"配置-mqtt-桥接的-broker-地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-mqtt-桥接的-broker-地址"}},[s._v("#")]),s._v(" 配置 MQTT 桥接的 Broker 地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 桥接地址： 使用节点名则用于 rpc 桥接，使用 host:port 用于 mqtt 连接")]),s._v("\nbridge.mqtt.aws.address "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:1883\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 桥接的协议版本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 枚举值: mqttv3 | mqttv4 | mqttv5")]),s._v("\nbridge.mqtt.aws.proto_ver "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mqttv4\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 连接是否启用桥接模式")]),s._v("\nbridge.mqtt.aws.bridge_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 客户端的 client_id")]),s._v("\nbridge.mqtt.aws.client_id "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bridge_aws\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 客户端的 clean_start 字段")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 注: 有些 MQTT Broker 需要将 clean_start 值设成 `true`")]),s._v("\nbridge.mqtt.aws.clean_start "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 客户端的 username 字段")]),s._v("\nbridge.mqtt.aws.username "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 客户端的 password 字段")]),s._v("\nbridge.mqtt.aws.password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## mqtt 客户端是否使用 ssl 来连接远程服务器")]),s._v("\nbridge.mqtt.aws.ssl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 客户端 SSL 连接的 CA 证书 (PEM格式)")]),s._v("\nbridge.mqtt.aws.cacertfile "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" etc/certs/cacert.pem\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 客户端 SSL 连接的 SSL 证书")]),s._v("\nbridge.mqtt.aws.certfile "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" etc/certs/client-cert.pem\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 客户端 SSL 连接的密钥文件")]),s._v("\nbridge.mqtt.aws.keyfile "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" etc/certs/client-key.pem\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## SSL 加密算法")]),s._v("\nbridge.mqtt.aws.ciphers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ECDHE-ECDSA-AES256-GCM-SHA384,ECDHE-RSA-AES256-GCM-SHA384\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## TLS PSK 的加密算法")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 注意 'listener.ssl.external.ciphers' 和 'listener.ssl.external.psk_ciphers' 不能同时配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## See 'https://tools.ietf.org/html/rfc4279#section-2'.")]),s._v("\nbridge.mqtt.aws.psk_ciphers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PSK-AES128-CBC-SHA,PSK-AES256-CBC-SHA,PSK-3DES-EDE-CBC-SHA,PSK-RC4-SHA\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 客户端的心跳间隔")]),s._v("\nbridge.mqtt.aws.keepalive "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 60s\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 支持的 TLS 版本")]),s._v("\nbridge.mqtt.aws.tls_versions "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tlsv1.2,tlsv1.1,tlsv1\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br")])]),n("h3",{attrs:{id:"配置-mqtt-桥接转发和订阅主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-mqtt-桥接转发和订阅主题"}},[s._v("#")]),s._v(" 配置 MQTT 桥接转发和订阅主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 桥接的 mountpoint(挂载点)")]),s._v("\nbridge.mqtt.aws.mountpoint "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bridge/aws/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v("/\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 转发消息的主题")]),s._v("\nbridge.mqtt.aws.forwards "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" topic1/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#,topic2/#")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 用于桥接的订阅主题")]),s._v("\nbridge.mqtt.aws.subscription.1.topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cmd/topic1\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 用于桥接的订阅 qos")]),s._v("\nbridge.mqtt.aws.subscription.1.qos "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 用于桥接的订阅主题")]),s._v("\nbridge.mqtt.aws.subscription.2.topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cmd/topic2\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 用于桥接的订阅 qos")]),s._v("\nbridge.mqtt.aws.subscription.2.qos "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h3",{attrs:{id:"mqtt-桥接转发和订阅主题说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-桥接转发和订阅主题说明"}},[s._v("#")]),s._v(" MQTT 桥接转发和订阅主题说明")]),s._v(" "),n("p",[s._v("挂载点 Mountpoint: mountpoint 用于在转发消息时加上主题前缀，该配置选项须配合 forwards 使用，转发主题为\nsensor1/hello 的消息, 到达远程节点时主题为 bridge/aws/emqx1@192.168.1.1/sensor1/hello。")]),s._v(" "),n("p",[s._v("转发主题 Forwards: 转发到本地 EMQX 指定 forwards 主题上的消息都会被转发到远程 MQTT Broker 上。")]),s._v(" "),n("p",[s._v("订阅主题 Subscription: 本地 EMQX 通过订阅远程 MQTT Broker 的主题来将远程 MQTT Broker\n上的消息同步到本地。")]),s._v(" "),n("h3",{attrs:{id:"启用-bridge-mqtt-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-bridge-mqtt-桥接插件"}},[s._v("#")]),s._v(" 启用 bridge_mqtt 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_mqtt\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"桥接-cli-命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#桥接-cli-命令"}},[s._v("#")]),s._v(" 桥接 CLI 命令")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx1/ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx_ctl bridges\nbridges list                                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# List bridges")]),s._v("\nbridges start "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start a bridge")]),s._v("\nbridges stop "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                             "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Stop a bridge")]),s._v("\nbridges forwards "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show a bridge forward topic")]),s._v("\nbridges add-forward "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Topic"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("              "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Add bridge forward topic")]),s._v("\nbridges del-forward "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Topic"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("              "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Delete bridge forward topic")]),s._v("\nbridges subscriptions "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Show a bridge subscriptions topic")]),s._v("\nbridges add-subscription "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Topic"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Qos"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Add bridge subscriptions topic")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"列出全部-bridge-状态"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出全部-bridge-状态"}},[s._v("#")]),s._v(" 列出全部 bridge 状态")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges list\nname: emqx     status: Stopped\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"启动指定-bridge"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动指定-bridge"}},[s._v("#")]),s._v(" 启动指定 bridge")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges start emqx\nStart bridge successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"停止指定-bridge"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#停止指定-bridge"}},[s._v("#")]),s._v(" 停止指定 bridge")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges stop emqx\nStop bridge successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"列出指定-bridge-的转发主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出指定-bridge-的转发主题"}},[s._v("#")]),s._v(" 列出指定 bridge 的转发主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges forwards emqx\ntopic:   topic1/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\ntopic:   topic2/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"添加指定-bridge-的转发主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加指定-bridge-的转发主题"}},[s._v("#")]),s._v(" 添加指定 bridge 的转发主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges add-forward emqx topic3/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nAdd-forward topic successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"删除指定-bridge-的转发主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除指定-bridge-的转发主题"}},[s._v("#")]),s._v(" 删除指定 bridge 的转发主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges del-forward emqx topic3/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nDel-forward topic successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"列出指定-bridge-的订阅"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出指定-bridge-的订阅"}},[s._v("#")]),s._v(" 列出指定 bridge 的订阅")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges subscriptions emqx\ntopic: cmd/topic1, qos: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ntopic: cmd/topic2, qos: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"添加指定-bridge-的订阅主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加指定-bridge-的订阅主题"}},[s._v("#")]),s._v(" 添加指定 bridge 的订阅主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges add-subscription emqx cmd/topic3 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nAdd-subscription topic successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"删除指定-bridge-的订阅主题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除指定-bridge-的订阅主题"}},[s._v("#")]),s._v(" 删除指定 bridge 的订阅主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ ./bin/emqx_ctl bridges del-subscription emqx cmd/topic3\nDel-subscription topic successfully.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"rpc-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rpc-桥接"}},[s._v("#")]),s._v(" RPC 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到远程 EMQX:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(416),alt:"image"}})]),s._v(" "),n("p",[s._v("rpc bridge 桥接插件配置文件: etc/plugins/emqx_bridge_mqtt.conf")]),s._v(" "),n("h3",{attrs:{id:"配置-rpc-桥接的-broker-地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rpc-桥接的-broker-地址"}},[s._v("#")]),s._v(" 配置 RPC 桥接的 Broker 地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bridge.mqtt.emqx.address "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emqx2@192.168.1.2\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"配置-mqtt-桥接转发和订阅主题-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-mqtt-桥接转发和订阅主题-2"}},[s._v("#")]),s._v(" 配置 MQTT 桥接转发和订阅主题")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 桥接的 mountpoint(挂载点)")]),s._v("\nbridge.mqtt.emqx.mountpoint "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bridge/emqx1/"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v("/\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 转发消息的主题")]),s._v("\nbridge.mqtt.emqx.forwards "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" topic1/"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#,topic2/#")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"mqtt-桥接转发和订阅主题说明-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-桥接转发和订阅主题说明-2"}},[s._v("#")]),s._v(" MQTT 桥接转发和订阅主题说明")]),s._v(" "),n("p",[s._v("挂载点 Mountpoint: mountpoint 用于在转发消息时加上主题前缀，该配置选项须配合 forwards 使用，转发主题为\nsensor1/hello 的消息, 到达远程节点时主题为 bridge/aws/emqx1@192.168.1.1/sensor1/hello。")]),s._v(" "),n("p",[s._v("转发主题 Forwards: 转发到本地 EMQX 指定 forwards 主题上的消息都会被转发到远程 MQTT Broker 上。")]),s._v(" "),n("h3",{attrs:{id:"桥接-cli-命令-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#桥接-cli-命令-2"}},[s._v("#")]),s._v(" 桥接 CLI 命令")]),s._v(" "),n("p",[s._v("桥接 CLI 的使用方式与 mqtt bridge 相同。")]),s._v(" "),n("h2",{attrs:{id:"kafka-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-桥接"}},[s._v("#")]),s._v(" Kafka 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 Kafka 集群，Apache Kafka是一个快速、高可扩展、高吞吐的分布式日志系统，配合kafka Stream，在流式数据处理中非常常用。")]),s._v(" "),n("p",[n("img",{attrs:{src:t(413),alt:"image"}})]),s._v(" "),n("p",[s._v("Kafka 桥接插件配置文件: etc/plugins/emqx_bridge_kafka.conf。")]),s._v(" "),n("h3",{attrs:{id:"配置-kafka-集群地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-kafka-集群地址"}},[s._v("#")]),s._v(" 配置 Kafka 集群地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Kafka 服务器地址")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.servers = 127.0.0.1:9092,127.0.0.2:9092,127.0.0.3:9092")]),s._v("\nbridge.kafka.servers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Kafka 分区策略。可选值: per_partition | per_broker")]),s._v("\nbridge.kafka.connection_strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" per_partition\n\nbridge.kafka.min_metadata_refresh_interval "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 5S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Produce 写类型。可选值: sync | async")]),s._v("\nbridge.kafka.produce "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n\nbridge.kafka.produce.sync_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 3S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 指定 replayq 在磁盘上存储消息的基本目录。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 如果该配置项缺失活着设置为 undefined, replayq 将以使用内存的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 的方式工作。也就是说，消息不在磁盘上排队 -- 在这种情况下，send")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 和 send_async API 的调用者负责处理在应用程序、网络或 kafka")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 干扰时可能丢失的消息。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.replayq_dir = /tmp/emqx_bridge_kafka/")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default=10MB, replayq 分段大小。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.producer.replayq_seg_bytes = 10MB")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## producer required_acks. 可选值: all_isr | leader_only | none.")]),s._v("\nbridge.kafka.producer.required_acks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" none\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default=10000. leader 在回复 producer 前等待副本的超时时间。")]),s._v("\nbridge.kafka.producer.ack_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 10S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 收集到一次 produce 请求中的最大字节数")]),s._v("\nbridge.kafka.producer.max_batch_bytes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1024KB\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 收集到一次 produce 请求中的最少字节数")]),s._v("\nbridge.kafka.producer.min_batch_bytes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 在没有接收到上次请求的 ack 的情况下，可以提前发送的 batch 数。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 如果消息必须严格按照顺序传递，则必须为0。")]),s._v("\nbridge.kafka.producer.max_send_ahead "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 默认为无压缩")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.producer.compression = no_compression")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 默认值为 base64, 可选值: base64 | plain")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.encode_payload_type = base64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.buffer = 32KB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.recbuf = 32KB")]),s._v("\nbridge.kafka.sock.sndbuf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1MB\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.read_packets = 20")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h3",{attrs:{id:"配置-kafka-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-kafka-桥接规则"}},[s._v("#")]),s._v(" 配置 Kafka 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge Kafka Hooks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${topic}: the kafka topics to which the messages will be published.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${filter}: the mqtt topic (may contain wildcard) on which the action will be performed.")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Connected Record Hook")]),s._v("\nbridge.kafka.hook.client.connected.1     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Disconnected Record Hook")]),s._v("\nbridge.kafka.hook.client.disconnected.1  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Subscribed Record Hook")]),s._v("\nbridge.kafka.hook.session.subscribed.1   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_subscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Unsubscribed Record Hook")]),s._v("\nbridge.kafka.hook.session.unsubscribed.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_unsubscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Publish Record Hook")]),s._v("\nbridge.kafka.hook.message.publish.1      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_publish"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Delivered Record Hook")]),s._v("\nbridge.kafka.hook.message.delivered.1    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_delivered"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Acked Record Hook")]),s._v("\nbridge.kafka.hook.message.acked.1        "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_acked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## More Configures")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## partitioner strategy:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option:  random | roundrobin | first_key_dispatch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "strategy":"random"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## key:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: ${clientid} | ${username}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "key":"${clientid}"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## format:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: json | json")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "format":"json"}')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("h3",{attrs:{id:"kafka-桥接规则说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-桥接规则说明"}},[s._v("#")]),s._v(" Kafka 桥接规则说明")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("事件")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("bridge.kafka.hook.client.connected.1")]),s._v(" "),n("td",[s._v("客户端登录")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.client.disconnected.1")]),s._v(" "),n("td",[s._v("客户端退出")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.session.subscribed.1")]),s._v(" "),n("td",[s._v("订阅主题")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.session.unsubscribed.1")]),s._v(" "),n("td",[s._v("取消订阅主题")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.publish.1")]),s._v(" "),n("td",[s._v("发布消息")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.delivered.1")]),s._v(" "),n("td",[s._v("delivered 消息")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.acked.1")]),s._v(" "),n("td",[s._v("ACK 消息")])])])]),s._v(" "),n("h3",{attrs:{id:"客户端上下线事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端上下线事件转发-kafka"}},[s._v("#")]),s._v(" 客户端上下线事件转发 Kafka")]),s._v(" "),n("p",[s._v("设备上线 EMQX 转发上线事件消息到 Kafka:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("设备下线 EMQX 转发下线事件消息到 Kafka:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reason"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${reason}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"客户端订阅主题事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-kafka"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_subscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"客户端取消订阅主题事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅主题事件转发-kafka"}},[s._v("#")]),s._v(" 客户端取消订阅主题事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_unsubscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息转发到-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发到-kafka"}},[s._v("#")]),s._v(" MQTT 消息转发到 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_publish\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息派发-deliver-事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息派发-deliver-事件转发-kafka"}},[s._v("#")]),s._v(" MQTT 消息派发 (Deliver) 事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_delivered\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息确认-ack-事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-kafka"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_acked\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"kafka-消费示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-消费示例"}},[s._v("#")]),s._v(" Kafka 消费示例")]),s._v(" "),n("p",[s._v("Kafka 读取 MQTT 客户端上下线事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic client_connected --from-beginning\n    \nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic client_disconnected --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 主题订阅事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic session_subscribed --from-beginning\n\nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic session_unsubscribed --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 发布消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_publish --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 消息发布 (Deliver)、确认 (Ack)事件:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_delivered --from-beginning\n\nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_acked --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("默认 payload 被 base64 编码，可通过修改配置 bridge.kafka.encode_payload_type 指定\npayload 数据格式。")])]),s._v(" "),n("h3",{attrs:{id:"启用-kafka-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-kafka-桥接插件"}},[s._v("#")]),s._v(" 启用 Kafka 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_kafka\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"rabbitmq-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-桥接"}},[s._v("#")]),s._v(" RabbitMQ 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 RabbitMQ 集群:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(414),alt:"image"}})]),s._v(" "),n("p",[s._v("RabbitMQ 桥接插件配置文件: etc/plugins/emqx_bridge_rabbit.conf。")]),s._v(" "),n("h3",{attrs:{id:"配置-rabbitmq-桥接地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rabbitmq-桥接地址"}},[s._v("#")]),s._v(" 配置 RabbitMQ 桥接地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的服务器地址")]),s._v("\nbridge.rabbit.1.server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:5672\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的连接池大小")]),s._v("\nbridge.rabbit.1.pool_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的用户名")]),s._v("\nbridge.rabbit.1.username "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guest\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的密码")]),s._v("\nbridge.rabbit.1.password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guest\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的虚拟 Host")]),s._v("\nbridge.rabbit.1.virtual_host "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的心跳间隔")]),s._v("\nbridge.rabbit.1.heartbeat "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.server = 127.0.0.1:5672")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.pool_size = 8")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.username = guest")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.password = guest")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.virtual_host = /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.heartbeat = 0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h3",{attrs:{id:"配置-rabbitmq-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rabbitmq-桥接规则"}},[s._v("#")]),s._v(" 配置 RabbitMQ 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge Hooks")]),s._v("\nbridge.rabbit.hook.client.subscribe.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_client_subscribe"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct:emq.subscription"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.client.unsubscribe.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_client_unsubscribe"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct:emq.unsubscription"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.publish.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYS")]),s._v('/#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_publish"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys")]),s._v('"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.publish.2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_publish"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.pub"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.acked.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_acked"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.acked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"客户端订阅主题事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-rabbitmq"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" subscribe\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.subscription\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jsx:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, proplists:get_value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("qos, Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("- TopicTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"客户端取消订阅事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅事件转发-rabbitmq"}},[s._v("#")]),s._v(" 客户端取消订阅事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" unsubscribe\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.unsubscription\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jsx:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, _Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("- TopicTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发-rabbitmq"}},[s._v("#")]),s._v(" MQTT 消息转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" binary:replace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("binary:replace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Topic, "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq."),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" emq.pub\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-publish-qos"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", byte, Qos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, pub_from"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("From"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-publish-msgid"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, emqx_base62:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emqx-topic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, Topic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Payload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息确认-ack-事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-rabbitmq"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" puback\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.acked\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-msg-acked"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emqx_base62:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"rabbitmq-订阅消费-mqtt-消息示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-订阅消费-mqtt-消息示例"}},[s._v("#")]),s._v(" RabbitMQ 订阅消费 MQTT 消息示例")]),s._v(" "),n("p",[s._v("Python RabbitMQ消费者代码示例:")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env python")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" pika\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" sys\n\nconnection "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pika"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BlockingConnection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pika"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ConnectionParameters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nchannel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" connection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exchange_declare"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exchange"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct:emq.subscription'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" exchange_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nresult "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" channel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue_declare"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exclusive"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nqueue_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue_bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exchange"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct:emq.subscription'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" queue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("queue_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" routing_key"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subscribe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" properties"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" [x] %r:%r"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("routing_key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("basic_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" queue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("queue_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" no_ack"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start_consuming"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("其他语言 RabbitMQ 客户端代码示例:")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/rabbitmq/rabbitmq-tutorials",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/rabbitmq/rabbitmq-tutorials"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"启用-rabbitmq-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-rabbitmq-桥接插件"}},[s._v("#")]),s._v(" 启用 RabbitMQ 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_rabbit\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"pulsar-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pulsar-桥接"}},[s._v("#")]),s._v(" Pulsar 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 Pulsar 集群:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(418),alt:"image"}})]),s._v(" "),n("p",[s._v("Pulsar 桥接插件配置文件: etc/plugins/emqx_bridge_pulsar.conf。")]),s._v(" "),n("h3",{attrs:{id:"配置-pulsar-集群地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-pulsar-集群地址"}},[s._v("#")]),s._v(" 配置 Pulsar 集群地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Pulsar 服务器集群配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.servers = 127.0.0.1:6650,127.0.0.2:6650,127.0.0.3:6650")]),s._v("\nbridge.pulsar.servers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6650\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 分区生产者是同步/异步模式选择")]),s._v("\nbridge.pulsar.produce "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生产者同步模式下的超时时间")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.produce.sync_timeout = 3s")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生产者 batch 的消息数量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.producer.batch_size = 1000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 默认情况下不为生产者启用压缩选项")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.producer.compression = no_compression")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 采用 base64 编码或不编码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.encode_payload_type = base64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.sock.buffer = 32KB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.sock.recbuf = 32KB")]),s._v("\nbridge.pulsar.sock.sndbuf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1MB\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.pulsar.sock.read_packets = 20")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h3",{attrs:{id:"配置-pulsar-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-pulsar-桥接规则"}},[s._v("#")]),s._v(" 配置 Pulsar 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge Pulsar Hooks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${topic}: the pulsar topics to which the messages will be published.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${filter}: the mqtt topic (may contain wildcard) on which the action will be performed .")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Connected Record Hook")]),s._v("\nbridge.pulsar.hook.client.connected.1     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Disconnected Record Hook")]),s._v("\nbridge.pulsar.hook.client.disconnected.1  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Subscribed Record Hook")]),s._v("\nbridge.pulsar.hook.session.subscribed.1   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_subscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Unsubscribed Record Hook")]),s._v("\nbridge.pulsar.hook.session.unsubscribed.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_unsubscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Publish Record Hook")]),s._v("\nbridge.pulsar.hook.message.publish.1      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_publish"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Delivered Record Hook")]),s._v("\nbridge.pulsar.hook.message.delivered.1    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_delivered"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Acked Record Hook")]),s._v("\nbridge.pulsar.hook.message.acked.1        "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_acked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## More Configures")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## partitioner strategy:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option:  random | roundrobin | first_key_dispatch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.pulsar.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "strategy":"random"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## key:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: ${clientid} | ${username}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.pulsar.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "key":"${clientid}"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## format:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: json | json")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.pulsar.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "format":"json"}')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("h3",{attrs:{id:"pulsar-桥接规则说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pulsar-桥接规则说明"}},[s._v("#")]),s._v(" Pulsar 桥接规则说明")]),s._v(" "),n("table",{staticStyle:{width:"85%"}},[n("colgroup",[n("col",{staticStyle:{width:"58%"}}),s._v(" "),n("col",{staticStyle:{width:"26%"}})]),s._v(" "),n("thead",[n("tr",{staticClass:"header"},[n("th",[s._v("事件")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.pulsar.hook.client.connected.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("客户端登录")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.pulsar.hook.client.disconnected.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("客户端退出")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.pulsar.hook.session.subscribed.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("订阅主题")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.pulsar.hook.session.unsubscribed.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("取消订阅主题    ")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.pulsar.hook.message.publish.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("发布消息")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.pulsar.hook.message.delivered.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("delivered 消息")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.pulsar.hook.message.acked.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("ACK 消息")])])])])]),s._v(" "),n("h3",{attrs:{id:"客户端上下线事件转发-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端上下线事件转发-pulsar"}},[s._v("#")]),s._v(" 客户端上下线事件转发 Pulsar")]),s._v(" "),n("p",[s._v("设备上线 EMQX 转发上线事件消息到 Pulsar:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("设备下线 EMQX 转发下线事件消息到 Pulsar:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reason"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${reason}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"客户端订阅主题事件转发-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-pulsar"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 Pulsar")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_subscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"客户端取消订阅主题事件转发-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅主题事件转发-pulsar"}},[s._v("#")]),s._v(" 客户端取消订阅主题事件转发 Pulsar")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_unsubscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息转发到-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发到-pulsar"}},[s._v("#")]),s._v(" MQTT 消息转发到 Pulsar")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_publish\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息派发-deliver-事件转发-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息派发-deliver-事件转发-pulsar"}},[s._v("#")]),s._v(" MQTT 消息派发 (Deliver) 事件转发 Pulsar")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_delivered\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息确认-ack-事件转发-pulsar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-pulsar"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 Pulsar")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_acked\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"pulsar-消费示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pulsar-消费示例"}},[s._v("#")]),s._v(" Pulsar 消费示例")]),s._v(" "),n("p",[s._v("Pulsar 读取 MQTT 客户端上下线事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("pulsar-client consume client_connected  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n\npulsar-client consume client_disconnected  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Pulsar 读取 MQTT 主题订阅事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("pulsar-client consume session_subscribed  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_subscribed"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n\npulsar-client consume session_unsubscribed  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_unsubscribed"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Pulsar 读取 MQTT 发布消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("pulsar-client consume message_publish  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_publish"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Pulsar 读取 MQTT 消息发布 (Deliver)、确认 (Ack)事件:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("pulsar-client consume message_delivered  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_delivered"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n\npulsar-client consume message_acked  -s "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_acked"')]),s._v(" -n "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("默认 payload 被 base64 编码，可通过修改配置 bridge.pulsar.encode_payload_type 指定 payload 数据格式。")])]),s._v(" "),n("h3",{attrs:{id:"启用-pulsar-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-pulsar-桥接插件"}},[s._v("#")]),s._v(" 启用 Pulsar 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_pulsar\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"rocketmq-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq-桥接"}},[s._v("#")]),s._v(" RocketMQ 桥接")]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 RocketMQ 集群:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(417),alt:"image"}})]),s._v(" "),n("p",[s._v("RocketMQ 桥接插件配置文件: etc/plugins/emqx_bridge_rocket.conf。")]),s._v(" "),n("h3",{attrs:{id:"配置-rocketmq-集群地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rocketmq-集群地址"}},[s._v("#")]),s._v(" 配置 RocketMQ 集群地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RocketMQ 服务器集群配置")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.servers = 127.0.0.1:9876,127.0.0.2:9876,127.0.0.3:9876")]),s._v("\nbridge.rocket.servers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9876\n\nbridge.rocket.refresh_topic_route_interval "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 5S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 分区生产者是同步/异步模式选择")]),s._v("\nbridge.rocket.produce "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生产者同步模式下的超时时间")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.produce.sync_timeout = 3s")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 生产者 batch 的消息数量")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.producer.batch_size = 100")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 采用 base64 编码或不编码")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.encode_payload_type = base64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.sock.buffer = 32KB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.sock.recbuf = 32KB")]),s._v("\nbridge.rocket.sock.sndbuf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1MB\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.rocket.sock.read_packets = 20")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("h3",{attrs:{id:"配置-rocketmq-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rocketmq-桥接规则"}},[s._v("#")]),s._v(" 配置 RocketMQ 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge RocketMQ Hooks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${topic}: the RocketMQ topics to which the messages will be published.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${filter}: the mqtt topic (may contain wildcard) on which the action will be performed .")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Connected Record Hook")]),s._v("\nbridge.rocket.hook.client.connected.1     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ClientConnected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Disconnected Record Hook")]),s._v("\nbridge.rocket.hook.client.disconnected.1  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ClientDisconnected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Subscribed Record Hook")]),s._v("\nbridge.rocket.hook.session.subscribed.1   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SessionSubscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Unsubscribed Record Hook")]),s._v("\nbridge.rocket.hook.session.unsubscribed.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SessionUnsubscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Publish Record Hook")]),s._v("\nbridge.rocket.hook.message.publish.1      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessagePublish"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Delivered Record Hook")]),s._v("\nbridge.rocket.hook.message.delivered.1    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessageDeliver"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Acked Record Hook")]),s._v("\nbridge.rocket.hook.message.acked.1        "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessageAcked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("h3",{attrs:{id:"rocketmq-桥接规则说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq-桥接规则说明"}},[s._v("#")]),s._v(" RocketMQ 桥接规则说明")]),s._v(" "),n("table",{staticStyle:{width:"85%"}},[n("colgroup",[n("col",{staticStyle:{width:"58%"}}),s._v(" "),n("col",{staticStyle:{width:"26%"}})]),s._v(" "),n("thead",[n("tr",{staticClass:"header"},[n("th",[s._v("事件")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.rocket.hook.client.connected.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("客户端登录")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.rocket.hook.client.disconnected.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("客户端退出")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.rocket.hook.session.subscribed.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("订阅主题")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.rocket.hook.session.unsubscribed.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("取消订阅主题    ")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.rocket.hook.message.publish.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("发布消息")])])]),s._v(" "),n("tr",{staticClass:"even"},[n("td",[s._v("bridge.rocket.hook.message.delivered.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("delivered 消息")])])]),s._v(" "),n("tr",{staticClass:"odd"},[n("td",[s._v("bridge.rocket.hook.message.acked.1")]),s._v(" "),n("td",[n("div",{staticClass:"line-block"},[s._v("ACK 消息")])])])])]),s._v(" "),n("h3",{attrs:{id:"客户端上下线事件转发-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端上下线事件转发-rocketmq"}},[s._v("#")]),s._v(" 客户端上下线事件转发 RocketMQ")]),s._v(" "),n("p",[s._v("设备上线 EMQX 转发上线事件消息到 RocketMQ:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ClientConnected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("设备下线 EMQX 转发下线事件消息到 RocketMQ:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ClientDisconnected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reason"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${reason}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"客户端订阅主题事件转发-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-rocketmq"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 RocketMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SessionSubscribed"')]),s._v("\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"客户端取消订阅主题事件转发-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅主题事件转发-rocketmq"}},[s._v("#")]),s._v(" 客户端取消订阅主题事件转发 RocketMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SessionUnsubscribed"')]),s._v("\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息转发到-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发到-rocketmq"}},[s._v("#")]),s._v(" MQTT 消息转发到 RocketMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessagePublish"')]),s._v("\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息派发-deliver-事件转发-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息派发-deliver-事件转发-rocketmq"}},[s._v("#")]),s._v(" MQTT 消息派发 (Deliver) 事件转发 RocketMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessageDeliver"')]),s._v("\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"mqtt-消息确认-ack-事件转发-rocketmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-rocketmq"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 RocketMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MessageAcked"')]),s._v("\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n         "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"rocketmq-消费示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rocketmq-消费示例"}},[s._v("#")]),s._v(" RocketMQ 消费示例")]),s._v(" "),n("p",[s._v("RocketMQ 读取 MQTT 客户端上下线事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer ClientConnected\n  \nbin/tools.sh org.apache.rocketmq.example.quickstart.Consumer ClientDisconnected\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("RocketMQ 读取 MQTT 主题订阅事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer SessionSubscribed\n\nbin/tools.sh org.apache.rocketmq.example.quickstart.Consumer SessionUnsubscribed\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("RocketMQ 读取 MQTT 发布消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer MessagePublish\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("RocketMQ 读取 MQTT 消息发布 (Deliver)、确认 (Ack) 事件:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer MessageDeliver\n\nbin/tools.sh org.apache.rocketmq.example.quickstart.Consumer MessageAcked\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("默认 payload 被 base64 编码，可通过修改配置 bridge.rocket.encode_payload_type 指定\npayload 数据格式。")])]),s._v(" "),n("h3",{attrs:{id:"启用-rocketmq-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-rocketmq-桥接插件"}},[s._v("#")]),s._v(" 启用 RocketMQ 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_rocket\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports},413:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_kafka.ce57abe1.png"},414:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_rabbit.cbb49156.png"},415:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_mqtt.068ad977.png"},416:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_rpc.5ab11835.png"},417:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_rocket.7e484e2b.png"},418:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_pulsar.46af6ff0.png"}}]);