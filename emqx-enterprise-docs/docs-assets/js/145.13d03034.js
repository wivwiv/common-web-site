(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{1682:function(s,a,t){"use strict";t.r(a);var e=t(10),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"命令行接口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#命令行接口"}},[s._v("#")]),s._v(" 命令行接口")]),s._v(" "),e("p",[s._v("EMQX 提供了 "),e("code",[s._v("./bin/emqx_ctl")]),s._v(" 的管理命令行，用于用户对 EMQX 进行管理、配置、查询。")]),s._v(" "),e("h2",{attrs:{id:"status-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#status-命令"}},[s._v("#")]),s._v(" status 命令")]),s._v(" "),e("p",[s._v("查询 EMQX 运行状态:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl status\nNode "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx@127.0.0.1'")]),s._v(" is started\nemqx v4.0.0 is running\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"mgmt-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-命令"}},[s._v("#")]),s._v(" mgmt 命令")]),s._v(" "),e("p",[s._v("mgmt 命令查询应用程序。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("mgmt list")])]),s._v(" "),e("td",[s._v("列出应用程序列表")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("mgmt insert <AppId> <Name>")])]),s._v(" "),e("td",[s._v("添加允许访问 HTTP API 的应用程序")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("mgmt update <AppId> <status>")])]),s._v(" "),e("td",[s._v("更新允许访问 HTTP API 的应用程序")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("mgmt lookup <AppId>")])]),s._v(" "),e("td",[s._v("获取允许访问 HTTP API 的应用程序详情")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("mgmt delete <AppId>")])]),s._v(" "),e("td",[s._v("删除允许访问 HTTP API 的应用程序")])])])]),s._v(" "),e("h3",{attrs:{id:"mgmt-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-list"}},[s._v("#")]),s._v(" mgmt list")]),s._v(" "),e("p",[s._v("列出应用程序列表:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl mgmt list\napp_id: 901abdba8eb8c, secret: MjgzMzQ5MjM1MzUzMTc4MjgyMjE3NzU4ODcwMDg0NjQ4OTG, name: hello, desc: , status: true, expired: undefined\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"mgmt-insert-appid-name"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-insert-appid-name"}},[s._v("#")]),s._v(" mgmt insert <AppId> <Name>")]),s._v(" "),e("p",[s._v("添加 HTTP API 的应用程序:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl mgmt insert dbcb6e023370b world\nAppSecret: MjgzMzQ5MjYyMTY3ODk4MjA5NzMwODExODMxMDM1NDk0NDA\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"mgmt-update-appid-status"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-update-appid-status"}},[s._v("#")]),s._v(" mgmt update <AppId> <status>")]),s._v(" "),e("p",[s._v("更新 HTTP API 的应用程序:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl mgmt update dbcb6e023370b stop\nupdate successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"mgmt-lookup-appid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-lookup-appid"}},[s._v("#")]),s._v(" mgmt lookup <AppId>")]),s._v(" "),e("p",[s._v("获取 HTTP API 的应用程序详情:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl mgmt lookup dbcb6e023370b\napp_id: dbcb6e023370b\nsecret: MjgzMzQ5MjYyMTY3ODk4MjA5NzMwODExODMxMDM1NDk0NDA\nname: world\ndesc: Application user\nstatus: stop\nexpired: undefined\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"mgmt-delete-appid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mgmt-delete-appid"}},[s._v("#")]),s._v(" mgmt delete <AppId>")]),s._v(" "),e("p",[s._v("删除 HTTP API 的应用程序:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl mgmt delete dbcb6e023370b\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"broker-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broker-命令"}},[s._v("#")]),s._v(" broker 命令")]),s._v(" "),e("p",[s._v("broker 命令查询服务器基本信息，启动时间，统计数据与性能数据。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("broker")])]),s._v(" "),e("td",[s._v("查询 EMQX 描述、版本、启动时间")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("broker stats")])]),s._v(" "),e("td",[s._v("查询连接 (Connection)、会话 (Session)、主题 (Topic)、订阅 (Subscription)、路由 (Route) 统计信息")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("broker metrics")])]),s._v(" "),e("td",[s._v("查询 MQTT 报文 (Packet)、消息 (Message) 收发统计")])])])]),s._v(" "),e("p",[s._v("查询 EMQX 基本信息，包括版本、启动时间等:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl broker\nsysdescr  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" EMQX Broker\nversion   "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.0")]),s._v(".0\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v("    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" minutes, "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("52")]),s._v(" seconds\ndatetime  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-02-21 09:39:58\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h3",{attrs:{id:"broker-stats"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broker-stats"}},[s._v("#")]),s._v(" broker stats")]),s._v(" "),e("p",[s._v("查询服务器客户端连接 (Connections)、主题 (Topics)、订阅 (Subscriptions)、路由 (Routes) 统计:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl broker stats\nchannels.count                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nchannels.max                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nconnections.count             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nconnections.max               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nresources.count               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nresources.max                 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nretained.count                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nretained.max                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nroutes.count                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nroutes.max                    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsessions.count                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsessions.max                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsuboptions.count              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsuboptions.max                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscribers.count             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscribers.max               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscriptions.count           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscriptions.max             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscriptions.shared.count    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsubscriptions.shared.max      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ntopics.count                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ntopics.max                    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br")])]),e("h3",{attrs:{id:"broker-metrics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broker-metrics"}},[s._v("#")]),s._v(" broker metrics")]),s._v(" "),e("p",[s._v("查询服务器流量 (Bytes)、MQTT 报文 (Packets)、消息 (Messages) 收发统计:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl broker metrics\nbytes.received                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nbytes.sent                    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.auth.anonymous         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.authenticate           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.check_acl              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.connack                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.connect                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.connected              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.disconnected           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.subscribe              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient.unsubscribe            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped.expired      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped.no_local     "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped.qos0_msg     "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped.queue_full   "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndelivery.dropped.too_large    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.acked                "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.delayed              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.delivered            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.dropped              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.dropped.expired      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.dropped.no_subscriber: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.forward              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.publish              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos0.received        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos0.sent            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos1.received        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos1.sent            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos2.received        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.qos2.sent            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.received             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmessages.retained             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nmessages.sent                 "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.auth.received         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.auth.sent             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.connack.auth_error    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.connack.error         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.connack.sent          "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.connect.received      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.disconnect.received   "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.disconnect.sent       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pingreq.received      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pingresp.sent         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.puback.inuse          "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.puback.missed         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.puback.received       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.puback.sent           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubcomp.inuse         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubcomp.missed        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubcomp.received      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubcomp.sent          "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.publish.auth_error    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.publish.dropped       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.publish.error         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.publish.received      "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.publish.sent          "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrec.inuse          "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrec.missed         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrec.received       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrec.sent           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrel.missed         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrel.received       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.pubrel.sent           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.received              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.sent                  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.suback.sent           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.subscribe.auth_error  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.subscribe.error       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.subscribe.received    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.unsuback.sent         "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.unsubscribe.error     "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\npackets.unsubscribe.received  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsession.created               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsession.discarded             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsession.resumed               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsession.takeovered            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsession.terminated            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br")])]),e("h2",{attrs:{id:"cluster-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cluster-命令"}},[s._v("#")]),s._v(" cluster 命令")]),s._v(" "),e("p",[s._v("cluster 命令可以管理由多个 EMQX 节点（进程）组成的集群:")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("cluster join <Node>")])]),s._v(" "),e("td",[s._v("加入集群")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("cluster leave")])]),s._v(" "),e("td",[s._v("离开集群")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("cluster force-leave <Node>")])]),s._v(" "),e("td",[s._v("从集群删除节点")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("cluster status")])]),s._v(" "),e("td",[s._v("查询集群状态")])])])]),s._v(" "),e("p",[s._v("示例:")]),s._v(" "),e("p",[s._v("为更好地展示 cluster 命令，我们可以先在单机上启动两个节点并组成集群，这称之为伪分布式启动模式。由于我们要在单机上启动两个 emqx 实例，为避免端口冲突，我们需要对其它节点的监听端口做出调整。")]),s._v(" "),e("p",[s._v("基本思路是复制一份 emqx 文件夹然后命名为 emqx2 ，将原先所有 emqx 节点监听的端口 port 加上一个偏移 offset 作为新的 emqx2 节点的监听端口。例如，将原先 emqx 的MQTT/TCP 监听端口由默认的 1883 改为了 2883 作为 emqx2 的 MQTT/TCP 监听端口。完成以上操作的自动化脚本可以参照 "),e("a",{attrs:{href:"https://github.com/terry-xiaoyu/one_more_emqx",target:"_blank",rel:"noopener noreferrer"}},[s._v("集群脚本"),e("OutboundLink")],1),s._v("，具体配置请参见 "),e("RouterLink",{attrs:{to:"/zh/enterprise/latest/getting-started/config.html"}},[s._v("配置说明")]),s._v(" 与 "),e("RouterLink",{attrs:{to:"/zh/enterprise/latest/configuration/configuration.html"}},[s._v("配置项")]),s._v("。")],1),s._v(" "),e("p",[s._v("启动 emqx1 :")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启动 emqx2 :")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx start\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("使用 "),e("code",[s._v("cluster join <Node>")]),s._v(" 将两个节点组成集群：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx_ctl cluster "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" emqx1@127.0.0.1\n\nJoin the cluster successfully.\nCluster status: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("running_nodes,"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx1@127.0.0.1'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx2@127.0.0.1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("任意节点目录下查询集群状态:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl cluster status\nCluster status: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("running_nodes,"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx2@127.0.0.1'")]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx1@127.0.0.1'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("集群消息路由测试:\nMQTT 命令行工具使用由 EMQX 团队开发的 "),e("a",{attrs:{href:"https://github.com/emqx/emqtt/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("emqtt"),e("OutboundLink")],1),s._v(" 客户端。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# emqx1 节点（1883 端口）订阅主题 x")]),s._v("\n$ ./bin/emqtt sub -t x -q "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1883")]),s._v("\nClient emqtt-a7de8fffbe2fbeb2fadb sent CONNECT\nClient emqtt-a7de8fffbe2fbeb2fadb subscribed to x\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向 emqx2 节点（2883 端口 ）发布消息")]),s._v("\n$ ./bin/emqtt pub -t x -q "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2883")]),s._v(" --payload hello\nClient emqtt-0898fa447676e17479a5 sent CONNECT\nClient emqtt-0898fa447676e17479a5 sent PUBLISH "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Q1, R0, D0, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Topic")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("x, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Payload")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" bytes"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\nClient emqtt-0898fa447676e17479a5 sent DISCONNECT\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# emqx1 节点（1883 端口）收到消息")]),s._v("\n$ ./bin/emqtt sub -t x -q "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1883")]),s._v("\nhello\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("emqx2 节点离开集群:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx2 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx_ctl cluster leave\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("强制 emqx2 节点离开集群，需要在集群下的目标节点以外的节点上进行操作:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" emqx1 "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./bin/emqx_ctl cluster force-leave emqx2@127.0.0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("注意，EMQX 不支持一个已经在一个集群中的节点加入另外一个集群，因为这会导致两个集群数据不一致，但支持加入过集群的节点在离开该集群后加入另一个集群。")]),s._v(" "),e("h2",{attrs:{id:"acl-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-命令"}},[s._v("#")]),s._v(" acl 命令")]),s._v(" "),e("p",[s._v("从 v4.1 之后引入了 "),e("code",[s._v("modules")]),s._v(" 的命令，我们使用以下命令重新加载 ACL：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl modules reload emqx_mod_acl_internal\nModule emqx_mod_acl_internal reloaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("在 v4.1 之前，则仍然使用：")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl acl reload\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"acl-cache-clean"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-cache-clean"}},[s._v("#")]),s._v(" acl cache-clean")]),s._v(" "),e("p",[s._v("在 v4.3 之后，引入了的命令来清理 ACL 缓存:")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("acl cache-clean all")]),s._v(" "),e("td",[s._v("清除集群中所有的 ACL 缓存")])]),s._v(" "),e("tr",[e("td",[s._v("acl cache-clean node <Node>")]),s._v(" "),e("td",[s._v("清除指定节点的 ACL 缓存")])]),s._v(" "),e("tr",[e("td",[s._v("acl cache-clean <ClientId>")]),s._v(" "),e("td",[s._v("清除指定客户端的 ACL 缓存")])])])]),s._v(" "),e("h2",{attrs:{id:"clients-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clients-命令"}},[s._v("#")]),s._v(" clients 命令")]),s._v(" "),e("p",[s._v("clients 命令查询连接的 MQTT 客户端。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("clients list")])]),s._v(" "),e("td",[s._v("列出所有客户端连接")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("clients show <ClientId>")])]),s._v(" "),e("td",[s._v("查询指定 ClientId 的客户端")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("clients kick <ClientId>")])]),s._v(" "),e("td",[s._v("踢除指定 ClientId 的客户端，连接与会话将一并终结。")])])])]),s._v(" "),e("h3",{attrs:{id:"clients-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clients-list"}},[s._v("#")]),s._v(" clients list")]),s._v(" "),e("p",[s._v("列出所有客户端连接:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl clients list\nClient "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mosqsub/43832-airlee.lo, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test1, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("peername")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:62135, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clean_start")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("keepalive")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("session_expiry_interval")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("subscriptions")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("inflight")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("awaiting_rel")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delivered_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enqueued_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dropped_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("created_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1582249657")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1582249657")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nClient "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mosqsub/44011-airlee.lo, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test2, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("peername")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:64961, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clean_start")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("keepalive")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("session_expiry_interval")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("subscriptions")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("inflight")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("awaiting_rel")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delivered_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enqueued_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dropped_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("created_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1582249657")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1582249657")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("disconnected_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1582249702")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("返回 Client 对象的属性:")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("Name")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("username")]),s._v(" "),e("td",[s._v("用户名")])]),s._v(" "),e("tr",[e("td",[s._v("peername")]),s._v(" "),e("td",[s._v("客户端 IP 与端口")])]),s._v(" "),e("tr",[e("td",[s._v("clean_start")]),s._v(" "),e("td",[s._v("MQTT Clean Start")])]),s._v(" "),e("tr",[e("td",[s._v("keepalive")]),s._v(" "),e("td",[s._v("MQTT KeepAlive")])]),s._v(" "),e("tr",[e("td",[s._v("session_expiry_interval")]),s._v(" "),e("td",[s._v("会话过期间隔")])]),s._v(" "),e("tr",[e("td",[s._v("subscriptions")]),s._v(" "),e("td",[s._v("当前订阅数量")])]),s._v(" "),e("tr",[e("td",[s._v("inflight")]),s._v(" "),e("td",[s._v("当前正在下发的 QoS 1 和 QoS 2 的消息总数")])]),s._v(" "),e("tr",[e("td",[s._v("awaiting_rel")]),s._v(" "),e("td",[s._v("等待客户端发送 PUBREL 的 QoS2 消息数")])]),s._v(" "),e("tr",[e("td",[s._v("delivered_msgs")]),s._v(" "),e("td",[s._v("EMQX 向此客户端转发的消息数量 (包含重传)")])]),s._v(" "),e("tr",[e("td",[s._v("enqueued_msgs")]),s._v(" "),e("td",[s._v("消息队列当前长度")])]),s._v(" "),e("tr",[e("td",[s._v("dropped_msgs")]),s._v(" "),e("td",[s._v("消息队列达到最大长度后丢弃的消息数量")])]),s._v(" "),e("tr",[e("td",[s._v("connected")]),s._v(" "),e("td",[s._v("是否在线")])]),s._v(" "),e("tr",[e("td",[s._v("created_at")]),s._v(" "),e("td",[s._v("会话创建时间戳")])]),s._v(" "),e("tr",[e("td",[s._v("connected_at")]),s._v(" "),e("td",[s._v("客户端连接时间戳")])]),s._v(" "),e("tr",[e("td",[s._v("disconnected_at")]),s._v(" "),e("td",[s._v("客户端断开连接时间戳（仅当断开连接还保留会话时才会出现）")])])])]),s._v(" "),e("h3",{attrs:{id:"clients-show-clientid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clients-show-clientid"}},[s._v("#")]),s._v(" clients show <ClientId>")]),s._v(" "),e("p",[s._v("查询指定 ClientId 的客户端:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl clients show "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mosqsub/43832-airlee.lo"')]),s._v("\nClient "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mosqsub/43832-airlee.lo, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test1, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("peername")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:62747, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clean_start")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("keepalive")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("session_expiry_interval")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7200")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("subscriptions")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("inflight")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("awaiting_rel")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("delivered_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enqueued_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("dropped_msgs")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("created_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1576479557")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connected_at")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1576479557")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"clients-kick-clientid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clients-kick-clientid"}},[s._v("#")]),s._v(" clients kick <ClientId>")]),s._v(" "),e("p",[s._v("踢除指定 ClientId 的客户端:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl clients kick "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clientid"')]),s._v("\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"routes-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#routes-命令"}},[s._v("#")]),s._v(" routes 命令")]),s._v(" "),e("p",[s._v("routes 命令用于查询路由信息。")]),s._v(" "),e("p",[s._v("EMQX 中路由是指主题与节点的映射关系，用于在多个节点之间路由消息。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("routes list")])]),s._v(" "),e("td",[s._v("列出所有路由")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("routes show <Topic>")])]),s._v(" "),e("td",[s._v("查询指定 Topic 的路由")])])])]),s._v(" "),e("h3",{attrs:{id:"routes-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#routes-list"}},[s._v("#")]),s._v(" routes list")]),s._v(" "),e("p",[s._v("列出所有路由:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl routes list\nt2/"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -> emqx2@127.0.0.1")]),s._v("\nt/+/x -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" emqx2@127.0.0.1,emqx@127.0.0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"routes-show-topic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#routes-show-topic"}},[s._v("#")]),s._v(" routes show <Topic>")]),s._v(" "),e("p",[s._v("查询指定 Topic d的路由:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl routes show t/+/x\nt/+/x -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" emqx2@127.0.0.1,emqx@127.0.0.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"subscriptions-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscriptions-命令"}},[s._v("#")]),s._v(" subscriptions 命令")]),s._v(" "),e("p",[s._v("subscriptions 命令查询消息服务器的订阅 (Subscription) 表。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("subscriptions list")])]),s._v(" "),e("td",[s._v("列出所有订阅")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("subscriptions show <ClientId>")])]),s._v(" "),e("td",[s._v("查询指定 ClientId 客户端的订阅")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("subscriptions add <ClientId> <Topic> <QoS>")])]),s._v(" "),e("td",[s._v("手动添加静态订阅")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("subscriptions del <ClientId> <Topic>")])]),s._v(" "),e("td",[s._v("手动删除静态订阅")])])])]),s._v(" "),e("h3",{attrs:{id:"subscriptions-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscriptions-list"}},[s._v("#")]),s._v(" subscriptions list")]),s._v(" "),e("p",[s._v("列出所有订阅:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl subscriptions list\nmosqsub/91042-airlee.lo -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" t/y:1\nmosqsub/90475-airlee.lo -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" t/+/x:2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"subscriptions-show-clientid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscriptions-show-clientid"}},[s._v("#")]),s._v(" subscriptions show <ClientId>")]),s._v(" "),e("p",[s._v("查询某个 Client 的订阅:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl subscriptions show "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mosqsub/90475-airlee.lo'")]),s._v("\nmosqsub/90475-airlee.lo -"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" t/+/x:2\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"subscriptions-add-clientid-topic-qos"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscriptions-add-clientid-topic-qos"}},[s._v("#")]),s._v(" subscriptions add <ClientId> <Topic> <QoS>")]),s._v(" "),e("p",[s._v("手动添加订阅关系:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl subscriptions "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mosqsub/90475-airlee.lo'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/world'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"subscriptions-del-clientid-topic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#subscriptions-del-clientid-topic"}},[s._v("#")]),s._v(" subscriptions del <ClientId> <Topic>")]),s._v(" "),e("p",[s._v("手动删除订阅关系:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl subscriptions del "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mosqsub/90475-airlee.lo'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/world'")]),s._v("\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"plugins-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins-命令"}},[s._v("#")]),s._v(" plugins 命令")]),s._v(" "),e("p",[s._v("plugins 命令用于加载、卸载、查询插件应用。EMQX 通过插件扩展认证、定制功能，插件配置位于 "),e("code",[s._v("etc/plugins/")]),s._v(" 目录下。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("plugins list")])]),s._v(" "),e("td",[s._v("列出全部插件 (Plugin)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("plugins load <Plugin>")])]),s._v(" "),e("td",[s._v("加载插件 (Plugin)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("plugins unload <Plugin>")])]),s._v(" "),e("td",[s._v("卸载插件 (Plugin)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("plugins reload <Plugin>")])]),s._v(" "),e("td",[s._v("重载插件 (Plugin)")])])])]),s._v(" "),e("p",[s._v("当配置文件发生更改，如果需要配置立即生效，你可以执行 "),e("code",[s._v("emqx_ctl reload <Plugin\\> 命令，即使插件在配置修改时并未处于运行状态，你也应当使用此命令而不是")]),s._v("emqx_ctl load <Plugin>，因为 `emqx_ctl load <Plugin> 不会编译新的配置文件。")]),s._v(" "),e("h3",{attrs:{id:"plugins-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins-list"}},[s._v("#")]),s._v(" plugins list")]),s._v(" "),e("p",[s._v("列出全部插件:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl plugins list\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nPlugin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_auth_http, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Authentication/ACL with HTTP API, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPlugin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_auth_jwt, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Authentication with JWT, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPlugin"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_auth_ldap, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Authentication/ACL with LDAP, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[s._v("插件属性:")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("Name")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("version")]),s._v(" "),e("td",[s._v("插件版本")])]),s._v(" "),e("tr",[e("td",[s._v("description")]),s._v(" "),e("td",[s._v("插件描述")])]),s._v(" "),e("tr",[e("td",[s._v("active")]),s._v(" "),e("td",[s._v("是否已加载")])])])]),s._v(" "),e("h3",{attrs:{id:"plugins-load-plugin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins-load-plugin"}},[s._v("#")]),s._v(" plugins load <Plugin>")]),s._v(" "),e("p",[s._v("加载插件:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl plugins load emqx_lua_hook\nPlugin emqx_lua_hook loaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"plugins-unload-plugin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins-unload-plugin"}},[s._v("#")]),s._v(" plugins unload <Plugin>")]),s._v(" "),e("p",[s._v("卸载插件:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl plugins unload emqx_lua_hook\nPlugin emqx_lua_hook unloaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"plugins-reload-plugin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins-reload-plugin"}},[s._v("#")]),s._v(" plugins reload <Plugin>")]),s._v(" "),e("p",[s._v("重载插件:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl plugins reload emqx_lua_hook\nPlugin emqx_lua_hook reloaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"modules-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-命令"}},[s._v("#")]),s._v(" modules 命令")]),s._v(" "),e("p",[s._v("自 v4.1 之后，引入了 "),e("code",[s._v("modules")]),s._v(" 命令用于在运行时管理 EMQX 内置的模块。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("modules list")])]),s._v(" "),e("td",[s._v("列出全部内置模块 (Module)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("modules load <Module>")])]),s._v(" "),e("td",[s._v("加载内置模块 (Module)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("modules unload <Module>")])]),s._v(" "),e("td",[s._v("卸载内置模块 (Module)")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("modules reload <Module>")])]),s._v(" "),e("td",[s._v("重载内置模块 (Module)")])])])]),s._v(" "),e("h3",{attrs:{id:"modules-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-list"}},[s._v("#")]),s._v(" modules list")]),s._v(" "),e("p",[s._v("列出全部内置模块:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl modules list\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_delayed, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Delayed Publish Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_topic_metrics, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Topic Metrics Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_subscription, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Subscription Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_acl_internal, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Internal ACL Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_rewrite, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Topic Rewrite Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nModule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("emqx_mod_presence, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("EMQX Presence Module, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("active")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h3",{attrs:{id:"modules-load"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-load"}},[s._v("#")]),s._v(" modules load")]),s._v(" "),e("p",[s._v("加载内置模块:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl modules load emqx_mod_delayed\nModule emqx_mod_delayed loaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"modules-unload"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-unload"}},[s._v("#")]),s._v(" modules unload")]),s._v(" "),e("p",[s._v("卸载内置模块:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl modules unload emqx_mod_delayed\nModule emqx_mod_delayed unloaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"modules-reload"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modules-reload"}},[s._v("#")]),s._v(" modules reload")]),s._v(" "),e("p",[s._v("重载内置模块:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl modules reload emqx_mod_acl_internal\nModule emqx_mod_acl_internal reloaded successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"vm-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-命令"}},[s._v("#")]),s._v(" vm 命令")]),s._v(" "),e("p",[s._v("vm 命令用于查询 Erlang 虚拟机负载、内存、进程、IO 信息。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("vm")])]),s._v(" "),e("td",[s._v("等同于 vm all")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm all")])]),s._v(" "),e("td",[s._v("查询 VM 全部信息")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm load")])]),s._v(" "),e("td",[s._v("查询 VM 负载")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm memory")])]),s._v(" "),e("td",[s._v("查询 VM 内存")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm process")])]),s._v(" "),e("td",[s._v("查询 VM Erlang 进程数量")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm io")])]),s._v(" "),e("td",[s._v("查询 VM io 最大文件句柄")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("vm ports")])]),s._v(" "),e("td",[s._v("查询 VM 的端口")])])])]),s._v(" "),e("h3",{attrs:{id:"vm-all"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-all"}},[s._v("#")]),s._v(" vm all")]),s._v(" "),e("p",[s._v("查询 VM 全部信息，包括负载、内存、Erlang 进程数量等:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm all\ncpu/load1               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.22")]),s._v("\ncpu/load5               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.29")]),s._v("\ncpu/load15              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.16")]),s._v("\nmemory/total            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("99995208")]),s._v("\nmemory/processes        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("38998248")]),s._v("\nmemory/processes_used   "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("38938520")]),s._v("\nmemory/system           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("60996960")]),s._v("\nmemory/atom             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1189073")]),s._v("\nmemory/atom_used        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1173808")]),s._v("\nmemory/binary           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("100336")]),s._v("\nmemory/code             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("25439961")]),s._v("\nmemory/ets              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("7161128")]),s._v("\nprocess/limit           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v("\nprocess/count           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("315")]),s._v("\nio/max_fds              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("\nio/active_fds           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nports/count             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\nports/limit             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("h3",{attrs:{id:"vm-load"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-load"}},[s._v("#")]),s._v(" vm load")]),s._v(" "),e("p",[s._v("查询 VM 负载:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm load\ncpu/load1               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.21")]),s._v("\ncpu/load5               "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.60")]),s._v("\ncpu/load15              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.36")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"vm-memory"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-memory"}},[s._v("#")]),s._v(" vm memory")]),s._v(" "),e("p",[s._v("查询 VM 内存:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm memory\nmemory/total            "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("23967736")]),s._v("\nmemory/processes        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3594216")]),s._v("\nmemory/processes_used   "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3593112")]),s._v("\nmemory/system           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("20373520")]),s._v("\nmemory/atom             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("512601")]),s._v("\nmemory/atom_used        "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("491955")]),s._v("\nmemory/binary           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("51432")]),s._v("\nmemory/code             "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("13401565")]),s._v("\nmemory/ets              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1082848")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("h3",{attrs:{id:"vm-process"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-process"}},[s._v("#")]),s._v(" vm process")]),s._v(" "),e("p",[s._v("查询 Erlang 进程数量及其限制:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm process\nprocess/limit           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v("\nprocess/count           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("314")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"vm-io"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-io"}},[s._v("#")]),s._v(" vm io")]),s._v(" "),e("p",[s._v("查询文件描述符数量及其限制:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm io\nio/max_fds              "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("\nio/active_fds           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"vm-ports"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vm-ports"}},[s._v("#")]),s._v(" vm ports")]),s._v(" "),e("p",[s._v("查询端口占用数量及其限制:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl vm ports\nports/count           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v("\nports/limit           "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"mnesia-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mnesia-命令"}},[s._v("#")]),s._v(" mnesia 命令")]),s._v(" "),e("p",[s._v("查询 mnesia 数据库系统状态。")]),s._v(" "),e("h2",{attrs:{id:"log-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-命令"}},[s._v("#")]),s._v(" log 命令")]),s._v(" "),e("p",[s._v("log 命令用于设置日志等级。访问 "),e("a",{attrs:{href:"http://erlang.org/doc/apps/kernel/logger_chapter.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Documentation of logger"),e("OutboundLink")],1),s._v(" 以获取详细信息")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("log set-level <Level>")])]),s._v(" "),e("td",[s._v("设置主日志等级和所有 Handlers 日志等级")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log primary-level")])]),s._v(" "),e("td",[s._v("查看主日志等级")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log primary-lelvel <Level>")])]),s._v(" "),e("td",[s._v("设置主日志等级")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log handlers list")])]),s._v(" "),e("td",[s._v("查看当前安装的所有 Handlers")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log handlers start <HandlerId>")])]),s._v(" "),e("td",[s._v("启动某个已停止的 Handler")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log handlers stop <HandlerId>")])]),s._v(" "),e("td",[s._v("停止某个 Handler")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("log handlers set-level <HandlerId> <Level>")])]),s._v(" "),e("td",[s._v("设置指定 Handler 的日志等级")])])])]),s._v(" "),e("p",[s._v("日志的等级由低到高分别为："),e("code",[s._v("debug | info | notice | warning | error | critical | alert | emergency")]),s._v("，日志等级越低，系统输出的日志数量越多，消耗的系统资源越大。为提高系统运行性能，默认的主日志等级是 error。")]),s._v(" "),e("h3",{attrs:{id:"log-set-level-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-set-level-level"}},[s._v("#")]),s._v(" log set-level <Level>")]),s._v(" "),e("p",[s._v("设置主日志等级和所有 Handlers 日志等级:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log set-level debug\ndebug\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"log-primary-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-primary-level"}},[s._v("#")]),s._v(" log primary-level")]),s._v(" "),e("p",[s._v("查看主日志等级:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log primary-level\ndebug\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"log-primary-level-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-primary-level-level"}},[s._v("#")]),s._v(" log primary-level <Level>")]),s._v(" "),e("p",[s._v("设置主日志等级:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log primary-level info\ninfo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"log-handlers-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-handlers-list"}},[s._v("#")]),s._v(" log handlers list")]),s._v(" "),e("p",[s._v("查看当前安装的所有 Handlers:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log handlers list\nLogHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ssl_handler, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("debug, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("console, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("started"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nLogHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("file, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("warning, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("log/emqx.log, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("started"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nLogHandler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("default, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("warning, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("console, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("status")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("started"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"log-handlers-start-handlerid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-handlers-start-handlerid"}},[s._v("#")]),s._v(" log handlers start <HandlerId>")]),s._v(" "),e("p",[s._v("启动 log handler "),e("code",[s._v("'default'")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log handlers start default\nlog handler default started\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"log-handlers-stop-handlerid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-handlers-stop-handlerid"}},[s._v("#")]),s._v(" log handlers stop <HandlerId>")]),s._v(" "),e("p",[s._v("停止 log handler "),e("code",[s._v("'default'")]),s._v(":")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log handlers stop default\nlog handler default stopped\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"log-handlers-set-level-handlerid-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log-handlers-set-level-handlerid-level"}},[s._v("#")]),s._v(" log handlers set-level <HandlerId> <Level>")]),s._v(" "),e("p",[s._v("设置指定 Handler 的日志等级:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log handlers set-level emqx_logger_handler error\nerror\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"trace-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-命令"}},[s._v("#")]),s._v(" trace 命令")]),s._v(" "),e("p",[s._v("trace 命令用于追踪某个 Client 或 Topic，打印日志信息到文件，详情请查看 "),e("RouterLink",{attrs:{to:"/zh/enterprise/latest/getting-started/log.html"}},[s._v("日志与追踪")]),s._v("。")],1),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("trace list")])]),s._v(" "),e("td",[s._v("列出所有开启的追踪")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("trace start client <ClientId> <File> [<Level>]")])]),s._v(" "),e("td",[s._v("开启 Client 追踪，存储指定等级的日志到文件")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("trace stop client <ClientId>")])]),s._v(" "),e("td",[s._v("关闭 Client 追踪")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("trace start topic <Topic> <File> [<Level>]")])]),s._v(" "),e("td",[s._v("开启 Topic 追踪，存储指定等级的日志到文件")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("trace stop topic <Topic>")])]),s._v(" "),e("td",[s._v("关闭 Topic 追踪")])])])]),s._v(" "),e("h3",{attrs:{id:"trace-start-client-clientid-file-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-start-client-clientid-file-level"}},[s._v("#")]),s._v(" trace start client <ClientId> <File> [ <Level> ]")]),s._v(" "),e("p",[s._v("开启 Client 追踪:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log primary-level debug\ndebug\n\n$ ./bin/emqx_ctl trace start client clientid log/clientid_trace.log\ntrace clientid clientid successfully\n\n$ ./bin/emqx_ctl trace start client clientid2 log/clientid2_trace.log error\ntrace clientid clientid2 successfully\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"trace-stop-client-clientid"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-stop-client-clientid"}},[s._v("#")]),s._v(" trace stop client <ClientId>")]),s._v(" "),e("p",[s._v("关闭 Client 追踪:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl trace stop client clientid\nstop tracing clientid clientid successfully\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"trace-start-topic-topic-file-level"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-start-topic-topic-file-level"}},[s._v("#")]),s._v(" trace start topic <Topic> <File> [ <Level> ]")]),s._v(" "),e("p",[s._v("开启 Topic 追踪:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl log primary-level debug\ndebug\n\n$ ./bin/emqx_ctl trace start topic topic log/topic_trace.log\ntrace topic topic successfully\n\n$ ./bin/emqx_ctl trace start topic topic2 log/topic2_trace.log error\ntrace topic topic2 successfully\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"trace-stop-topic-topic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-stop-topic-topic"}},[s._v("#")]),s._v(" trace stop topic <Topic>")]),s._v(" "),e("p",[s._v("关闭 Topic 追踪:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl trace topic topic off\nstop tracing topic topic successfully\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"trace-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#trace-list"}},[s._v("#")]),s._v(" trace list")]),s._v(" "),e("p",[s._v("列出所有开启的追踪:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl trace list\nTrace "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("clientid"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("clientid2, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("error, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"log/clientid2_trace.log"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTrace "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("topic"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("topic2, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("level")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("error, "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("destination")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"log/topic2_trace.log"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"listeners"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listeners"}},[s._v("#")]),s._v(" listeners")]),s._v(" "),e("p",[s._v("listeners 命令用于查询开启的 TCP 服务监听器。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("listeners")]),s._v(" "),e("td",[s._v("# List listeners")])]),s._v(" "),e("tr",[e("td",[s._v("listeners stop    <Identifier>")]),s._v(" "),e("td",[s._v("# Stop a listener")])]),s._v(" "),e("tr",[e("td",[s._v("listeners stop    <Proto> <Port>")]),s._v(" "),e("td",[s._v("# Stop a listener")])]),s._v(" "),e("tr",[e("td",[s._v("listeners restart <Identifier>")]),s._v(" "),e("td",[s._v("# Restart a listener")])])])]),s._v(" "),e("h3",{attrs:{id:"listeners-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listeners-list"}},[s._v("#")]),s._v(" listeners list")]),s._v(" "),e("p",[s._v("查询开启的 TCP 服务监听器:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl listeners\nmqtt:ssl:external\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8883\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("102400")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmqtt:tcp:external\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:1883\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024000")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmqtt:tcp:internal\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:11883\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024000")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nhttp:dashboard\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:18083\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nhttp:management\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8081\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmqtt:ws:external\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8083\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("102400")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmqtt:wss:external\n  listen_on       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8084\n  acceptors       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n  max_conns       "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n  current_conn    "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  shutdown_count  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br")])]),e("p",[s._v("listener 参数说明:")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("Name")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("acceptors")]),s._v(" "),e("td",[s._v("TCP Acceptor 池")])]),s._v(" "),e("tr",[e("td",[s._v("max_conns")]),s._v(" "),e("td",[s._v("最大允许连接数")])]),s._v(" "),e("tr",[e("td",[s._v("current_conns")]),s._v(" "),e("td",[s._v("当前连接数")])]),s._v(" "),e("tr",[e("td",[s._v("shutdown_count")]),s._v(" "),e("td",[s._v("连接关闭原因统计")])])])]),s._v(" "),e("h3",{attrs:{id:"listeners-stop"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listeners-stop"}},[s._v("#")]),s._v(" listeners stop")]),s._v(" "),e("p",[s._v("停止监听端口:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl listeners stop mqtt:tcp:external\nStop mqtt:tcp:external listener on "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:1883 successfully.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"listeners-restart"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#listeners-restart"}},[s._v("#")]),s._v(" listeners restart")]),s._v(" "),e("p",[s._v("重启监听器:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl listeners restart http:dashboard\nStop http:dashboard listener on "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:18083 successfully.\nStart http:dashboard listener on "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:18083 successfully.\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h2",{attrs:{id:"recon-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#recon-命令"}},[s._v("#")]),s._v(" recon 命令")]),s._v(" "),e("p",[s._v("EMQX 的 recon 命令基于 Erlang Recon 库实现，用于帮助 DevOps 人员诊断生产节点中的问题，普通用户无需关心。使用 recon 命令会耗费一定的性能，请谨慎使用。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("recon memory")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon_alloc.html#memory-2",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon_alloc:memory/2"),e("OutboundLink")],1)])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("recon allocated")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon_alloc.html#memory-2",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon_alloc:memory (allocated_types, current/max)"),e("OutboundLink")],1)])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("recon bin_leak")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon.html#bin_leak-1",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon:bin_leak (100)"),e("OutboundLink")],1)])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("recon node_stats")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon.html#node_stats_print-2",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon:node_stats_print(10, 1000)"),e("OutboundLink")],1)])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("recon remote_load Mod")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon.html#remote_load-1",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon:remote_load (Mod)"),e("OutboundLink")],1)])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("recon proc_count Attr N")])]),s._v(" "),e("td",[e("a",{attrs:{href:"http://ferd.github.io/recon/recon.html#proc_count-2",target:"_blank",rel:"noopener noreferrer"}},[s._v("recon:proc_count(Attr, N)"),e("OutboundLink")],1)])])])]),s._v(" "),e("p",[s._v("访问 "),e("a",{attrs:{href:"http://ferd.github.io/recon/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Documentation for recon"),e("OutboundLink")],1),s._v(" 以获取详细信息。")]),s._v(" "),e("h2",{attrs:{id:"retainer-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retainer-命令"}},[s._v("#")]),s._v(" retainer 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("retainer info")])]),s._v(" "),e("td",[s._v("显示保留消息的数量")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("retainer topics")])]),s._v(" "),e("td",[s._v("显示当前存储的保留消息的所有主题")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("retainer clean")])]),s._v(" "),e("td",[s._v("清除所有保留的消息")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("retainer clean <Topic>")])]),s._v(" "),e("td",[s._v("清除指定的主题下的保留的消息")])])])]),s._v(" "),e("h3",{attrs:{id:"retainer-info"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retainer-info"}},[s._v("#")]),s._v(" retainer info")]),s._v(" "),e("p",[s._v("显示保留消息的数量:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl retainer info\nretained/total: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"retainer-topics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retainer-topics"}},[s._v("#")]),s._v(" retainer topics")]),s._v(" "),e("p",[s._v("显示当前存储的保留消息的所有主题:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl retainer topics\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYS")]),s._v("/brokers/emqx@127.0.0.1/version\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYS")]),s._v("/brokers/emqx@127.0.0.1/sysdescr\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYS")]),s._v("/brokers\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"retainer-clean"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retainer-clean"}},[s._v("#")]),s._v(" retainer clean")]),s._v(" "),e("p",[s._v("清除所有保留的消息:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl retainer clean\nCleaned "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" retained messages\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"retainer-clean-topic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retainer-clean-topic"}},[s._v("#")]),s._v(" retainer clean <Topic>")]),s._v(" "),e("p",[s._v("清除指定的主题下的保留的消息:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl retainer clean topic\nCleaned "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" retained messages\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"admins-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#admins-命令"}},[s._v("#")]),s._v(" admins 命令")]),s._v(" "),e("p",[s._v("用于创建、删除管理员账号，重置管理员密码。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("admins add <Username> <Password> <Tags>")])]),s._v(" "),e("td",[s._v("创建 admin 账号")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("admins passwd <Username> <Password>")])]),s._v(" "),e("td",[s._v("重置 admin 密码")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("admins del <Username>")])]),s._v(" "),e("td",[s._v("删除 admin 账号")])])])]),s._v(" "),e("h3",{attrs:{id:"admins-add-username-password-tags"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#admins-add-username-password-tags"}},[s._v("#")]),s._v(" admins add <Username> <Password> <Tags>")]),s._v(" "),e("p",[s._v("创建 admin 账户:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl admins "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" root public "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"admins-passwd-username-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#admins-passwd-username-password"}},[s._v("#")]),s._v(" admins passwd <Username> <Password>")]),s._v(" "),e("p",[s._v("重置 admin 账户密码:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl admins "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" root private\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"admins-del-username"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#admins-del-username"}},[s._v("#")]),s._v(" admins del <Username>")]),s._v(" "),e("p",[s._v("删除 admin 账户:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl admins del root\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"规则引擎-rule-engine-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#规则引擎-rule-engine-命令"}},[s._v("#")]),s._v(" 规则引擎(rule engine) 命令")]),s._v(" "),e("h3",{attrs:{id:"rules-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-命令"}},[s._v("#")]),s._v(" rules 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("rules list")])]),s._v(" "),e("td",[s._v("List all rules")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("rules show <RuleId>")])]),s._v(" "),e("td",[s._v("Show a rule")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("rules create <sql> <actions> [-d [<descr>]]")])]),s._v(" "),e("td",[s._v("Create a rule")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("rules delete <RuleId>")])]),s._v(" "),e("td",[s._v("Delete a rule")])])])]),s._v(" "),e("h4",{attrs:{id:"rules-create"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-create"}},[s._v("#")]),s._v(" rules create")]),s._v(" "),e("p",[s._v("创建一个新的规则。参数:")]),s._v(" "),e("ul",[e("li",[e("em",[e("code",[s._v("<sql>")])]),s._v(": 规则 SQL")]),s._v(" "),e("li",[e("em",[e("code",[s._v("<actions>")])]),s._v(": JSON 格式的动作列表")]),s._v(" "),e("li",[e("em",[e("code",[s._v("-d <descr>")])]),s._v(": 可选，规则描述信息")])]),s._v(" "),e("p",[s._v("使用举例:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 创建一个测试规则，简单打印所有发送到 't/a' 主题的消息内容")]),s._v("\n$ ./bin/emqx_ctl rules create "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select * from \"t/a\"'")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'[{"name":"inspect", "params": {"a": 1}}]\'')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    -d "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Rule for debug'")]),s._v("\n\nRule rule:9a6a725d created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("上例创建了一个 ID 为 "),e("code",[s._v("rule:9a6a725d")]),s._v(" 的规则，动作列表里只有一个动作：动作名为 inspect，动作的参数是\n"),e("code",[s._v('{"a": 1}')]),s._v("。")]),s._v(" "),e("h4",{attrs:{id:"rules-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-list"}},[s._v("#")]),s._v(" rules list")]),s._v(" "),e("p",[s._v("列出当前所有的规则:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl rules list\n\nrule"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rule:9a6a725d'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("for")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'['")]),s._v("t/a"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("']'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("rawsql")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select * from \"t/a\"'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("actions")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"metrics"')]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".,"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspect"')]),s._v(","),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"params"')]),s._v(":"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("metrics")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("., "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("enabled")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'true'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Rule for debug'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"rules-show"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-show"}},[s._v("#")]),s._v(" rules show")]),s._v(" "),e("p",[s._v("查询规则:")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("## 查询 RuleID 为 'rule:9a6a725d' 的规则\n$ ./bin/emqx_ctl rules show 'rule:9a6a725d'\n\nrule(id='rule:9a6a725d', for='['t/a']', rawsql='select * from \"t/a\"', actions=[{\"metrics\":...,\"name\":\"inspect\",\"params\":...}], metrics=..., enabled='true', description='Rule for debug')\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"rules-delete"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rules-delete"}},[s._v("#")]),s._v(" rules delete")]),s._v(" "),e("p",[s._v("删除规则:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 删除 RuleID 为 'rule:9a6a725d' 的规则")]),s._v("\n$ ./bin/emqx_ctl rules delete "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rule:9a6a725d'")]),s._v("\n\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h3",{attrs:{id:"rule-actions-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rule-actions-命令"}},[s._v("#")]),s._v(" rule-actions 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("rule-actions list")])]),s._v(" "),e("td",[s._v("List actions")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("rule-actions show <ActionId>")])]),s._v(" "),e("td",[s._v("Show a rule action")])])])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),e("p",[s._v("动作可以由 EMQX 内置(称为系统内置动作)，或者由 EMQX 插件编写，但不能通过 CLI/API 添加或删除。")])]),s._v(" "),e("h4",{attrs:{id:"rule-actions-show"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rule-actions-show"}},[s._v("#")]),s._v(" rule-actions show")]),s._v(" "),e("p",[s._v("查询动作:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 查询名为 'inspect' 的动作")]),s._v("\n$ ./bin/emqx_ctl rule-actions show "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'inspect'")]),s._v("\n\naction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'inspect'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_rule_engine'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("types")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Inspect (debug)'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Inspect the details of action params for debug purpose'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("h4",{attrs:{id:"rule-actions-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rule-actions-list"}},[s._v("#")]),s._v(" rule-actions list")]),s._v(" "),e("p",[s._v("列出符合条件的动作:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 列出当前所有的动作")]),s._v("\n$ ./bin/emqx_ctl rule-actions list\n\naction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data_to_rabbit'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_bridge_rabbit'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("types")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("bridge_rabbit"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Data bridge to RabbitMQ'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Store Data to Kafka'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\naction"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'data_to_timescaledb'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("app")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_backend_pgsql'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("types")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("timescaledb"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Data to TimescaleDB'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Store data to TimescaleDB'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"resources-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources-命令"}},[s._v("#")]),s._v(" resources 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("resources create <type> [-c [<config>]] [-d [<descr>]]")])]),s._v(" "),e("td",[s._v("Create a resource")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("resources list [-t <ResourceType>]")])]),s._v(" "),e("td",[s._v("List resources")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("resources show <ResourceId>")])]),s._v(" "),e("td",[s._v("Show a resource")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("resources delete <ResourceId>")])]),s._v(" "),e("td",[s._v("Delete a resource")])])])]),s._v(" "),e("h4",{attrs:{id:"resources-create"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources-create"}},[s._v("#")]),s._v(" resources create")]),s._v(" "),e("p",[s._v("创建一个新的资源，参数:")]),s._v(" "),e("ul",[e("li",[s._v("type: 资源类型")]),s._v(" "),e("li",[s._v("-c config: JSON 格式的配置")]),s._v(" "),e("li",[s._v("-d descr: 可选，资源的描述")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resources create "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web_hook'")]),s._v(" -c "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"url": "http://host-name/chats"}\'')]),s._v(" -d "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'forward msgs to host-name/chats'")]),s._v("\n\nResource resource:a7a38187 created\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"resources-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources-list"}},[s._v("#")]),s._v(" resources list")]),s._v(" "),e("p",[s._v("列出当前所有的资源:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resources list\n\nresource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'resource:a7a38187'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web_hook'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("config")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#{<<"url">> => <<"http://host-name/chats">>}, status=#{is_alive => false}, description=\'forward msgs to host-name/chats\')')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("列出当前某个类型的资源:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resources list --type"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web_hook'")]),s._v("\n\nresource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'resource:a7a38187'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web_hook'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("config")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#{<<"url">> => <<"http://host-name/chats">>}, status=#{is_alive => false}, description=\'forward msgs to host-name/chats\')')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"resources-show"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources-show"}},[s._v("#")]),s._v(" resources show")]),s._v(" "),e("p",[s._v("查询资源:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resources show "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'resource:a7a38187'")]),s._v("\n\nresource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'resource:a7a38187'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'web_hook'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("config")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#{<<"url">> => <<"http://host-name/chats">>}, status=#{is_alive => false}, description=\'forward msgs to host-name/chats\')')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"resources-delete"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resources-delete"}},[s._v("#")]),s._v(" resources delete")]),s._v(" "),e("p",[s._v("删除资源:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resources delete "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'resource:a7a38187'")]),s._v("\n\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h3",{attrs:{id:"resource-types-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resource-types-命令"}},[s._v("#")]),s._v(" resource-types 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("resource-types list")]),s._v(" "),e("td",[s._v("List all resource-types")])]),s._v(" "),e("tr",[e("td",[s._v("resource-types show "),e("code",[s._v("<Type>")])]),s._v(" "),e("td",[s._v("Show a resource-type")])])])]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),e("p",[s._v("资源类型可以由 EMQX 内置(称为系统内置资源类型)，或者由 EMQX 插件编写，但不能通过 CLI/API 添加或删除。")])]),s._v(" "),e("h4",{attrs:{id:"resource-types-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resource-types-list"}},[s._v("#")]),s._v(" resource-types list")]),s._v(" "),e("p",[s._v("列出当前所有的资源类型:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl resource-types list\n\nresource_type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backend_mongo_rs'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("provider")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_backend_mongo'")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MongoDB Replica Set Mode'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MongoDB Replica Set Mode'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nresource_type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backend_cassa'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("provider")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_backend_cassa'")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Cassandra'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Cassandra Database'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("h4",{attrs:{id:"resource-types-show"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#resource-types-show"}},[s._v("#")]),s._v(" resource-types show")]),s._v(" "),e("p",[s._v("查询资源类型:")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ ./bin/emqx_ctl resource-types show backend_mysql\n\nresource_type"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'backend_mysql'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("provider")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'emqx_backend_mysql'")]),s._v(", title "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MySQL'")]),s._v(", "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("description")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MySQL Database'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h2",{attrs:{id:"与规则引擎相关的状态、统计指标和告警"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#与规则引擎相关的状态、统计指标和告警"}},[s._v("#")]),s._v(" 与规则引擎相关的状态、统计指标和告警")]),s._v(" "),e("h3",{attrs:{id:"规则状态和统计指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#规则状态和统计指标"}},[s._v("#")]),s._v(" 规则状态和统计指标")]),s._v(" "),e("p",[e("img",{attrs:{src:t(959),alt:"image"}})]),s._v(" "),e("ul",[e("li",[s._v("已命中: 规则命中(规则 SQL 匹配成功)的次数，")]),s._v(" "),e("li",[s._v("命中速度: 规则命中的速度(次/秒)")]),s._v(" "),e("li",[s._v("最大命中速度: 规则命中速度的峰值(次/秒)")]),s._v(" "),e("li",[s._v("5分钟平均速度: 5分钟内规则的平均命中速度(次/秒)")])]),s._v(" "),e("h3",{attrs:{id:"动作状态和统计指标"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#动作状态和统计指标"}},[s._v("#")]),s._v(" 动作状态和统计指标")]),s._v(" "),e("p",[e("img",{attrs:{src:t(960),alt:"image"}})]),s._v(" "),e("ul",[e("li",[s._v("成功: 动作执行成功次数")]),s._v(" "),e("li",[s._v("失败: 动作执行失败次数")])]),s._v(" "),e("h3",{attrs:{id:"资源状态和告警"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#资源状态和告警"}},[s._v("#")]),s._v(" 资源状态和告警")]),s._v(" "),e("p",[e("img",{attrs:{src:t(961),alt:"image"}})]),s._v(" "),e("ul",[e("li",[s._v("可用: 资源可用")]),s._v(" "),e("li",[s._v("不可用: 资源不可用(比如数据库连接断开)")])]),s._v(" "),e("h2",{attrs:{id:"emqx-内置数据库-auth-与-acl-规则"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#emqx-内置数据库-auth-与-acl-规则"}},[s._v("#")]),s._v(" EMQX 内置数据库 Auth 与 ACL 规则")]),s._v(" "),e("p",[s._v("此命令只有在开启 emqx_auth_mnesia 插件后生效")]),s._v(" "),e("h3",{attrs:{id:"clientid-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clientid-命令"}},[s._v("#")]),s._v(" clientid 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("clientid list")]),s._v(" "),e("td",[s._v("List clientid auth rules")])]),s._v(" "),e("tr",[e("td",[s._v("clientid add "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Add clientid auth rule")])]),s._v(" "),e("tr",[e("td",[s._v("clientid update "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Update clientid auth rule")])]),s._v(" "),e("tr",[e("td",[s._v("clientid del "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Delete clientid auth rule")])])])]),s._v(" "),e("h4",{attrs:{id:"clientid-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clientid-list"}},[s._v("#")]),s._v(" clientid list")]),s._v(" "),e("p",[s._v("列出所有的 clientid 验证规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl clientid list\nemqx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"clientid-add-clientid-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clientid-add-clientid-password"}},[s._v("#")]),s._v(" clientid add "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("增加 clientid 验证规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl clientid "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" emqx public\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"clientid-update-clientid-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clientid-update-clientid-password"}},[s._v("#")]),s._v(" clientid update "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("更新 ClientID 验证的密码")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl clientid update emqx new_password\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"clientid-del-clientid-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#clientid-del-clientid-password"}},[s._v("#")]),s._v(" clientid del "),e("code",[s._v("<ClientID>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("删除 clientid 验证规则码")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl clientid del emqx new_password\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"user-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-命令"}},[s._v("#")]),s._v(" user 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[s._v("user list")]),s._v(" "),e("td",[s._v("List username auth rules")])]),s._v(" "),e("tr",[e("td",[s._v("user add "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Add username auth rule")])]),s._v(" "),e("tr",[e("td",[s._v("user update "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Update username auth rule")])]),s._v(" "),e("tr",[e("td",[s._v("user del "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("td",[s._v("Delete username auth rule")])])])]),s._v(" "),e("h4",{attrs:{id:"user-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-list"}},[s._v("#")]),s._v(" user list")]),s._v(" "),e("p",[s._v("列出所有的 username 验证规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl user list\nemqx\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"user-add-username-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-add-username-password"}},[s._v("#")]),s._v(" user add "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("增加 username 验证规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl user "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" emqx public\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"user-update-username-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-update-username-password"}},[s._v("#")]),s._v(" user update "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("更新 ClientID 验证的密码")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl user update emqx new_password\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h4",{attrs:{id:"user-del-username-password"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#user-del-username-password"}},[s._v("#")]),s._v(" user del "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Password>")])]),s._v(" "),e("p",[s._v("删除 username 验证规则码")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl user del emqx new_password\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"acl-命令-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-命令-2"}},[s._v("#")]),s._v(" acl 命令")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("acl list clientid")])]),s._v(" "),e("td",[s._v("List clientid acls")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl list username")])]),s._v(" "),e("td",[s._v("List username acls")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl list _all")])]),s._v(" "),e("td",[s._v("List $all acls")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl show clientid <Clientid>")])]),s._v(" "),e("td",[s._v("Lookup clientid acl detail")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl show username <Username>")])]),s._v(" "),e("td",[s._v("Lookup username acl detail")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl aad clientid <Clientid> <Topic> <Action> <Access>")])]),s._v(" "),e("td",[s._v("Add clientid acl")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl add Username <Username> <Topic> <Action> <Access>")])]),s._v(" "),e("td",[s._v("Add username acl")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl add _all <Topic> <Action> <Access>")])]),s._v(" "),e("td",[s._v("Add $all acl")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl del clientid <Clientid> <Topic>")])]),s._v(" "),e("td",[s._v("Delete clientid acl")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl del username <Username> <Topic>")])]),s._v(" "),e("td",[s._v("Delete username acl")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("acl del _all \\<Topic>")])]),s._v(" "),e("td",[s._v("Delete $all acl")])])])]),s._v(" "),e("h4",{attrs:{id:"acl-list"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-list"}},[s._v("#")]),s._v(" acl list")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("acl list "),e("code",[s._v("clientid")])]),s._v(" "),e("p",[s._v("列出 clientid 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl list clientid\nAcl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("clientid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_clientid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" topic "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Topic/A"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" action "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pub access "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" allow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl list "),e("code",[s._v("username")])]),s._v(" "),e("p",[s._v("列出 username 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl list username\nAcl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_username"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" topic "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Topic/B"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" action "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sub access "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" deny"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl list "),e("code",[s._v("_all")])]),s._v(" "),e("p",[s._v("列出 $all 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl list _all\nAcl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$all")]),s._v(" topic "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Topic/C"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" action "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pubsub access "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" allow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h4",{attrs:{id:"acl-show"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-show"}},[s._v("#")]),s._v(" acl show")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("acl show clientid "),e("code",[s._v("<Clientid>")])]),s._v(" "),e("p",[s._v("展示某一的 clientid ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl show clientid emqx_clientid\nAcl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("clientid "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_clientid"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" topic "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Topic/A"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" action "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pub access "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" allow"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl show username "),e("code",[s._v("<Username>")])]),s._v(" "),e("p",[s._v("展示某一的 username ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl show username emqx_username\nAcl"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("username "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"emqx_username"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" topic "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Topic/B"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" action "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sub access "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" deny"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h4",{attrs:{id:"acl-add"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-add"}},[s._v("#")]),s._v(" acl add")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("acl aad clientid "),e("code",[s._v("<Clientid>")]),s._v(" "),e("code",[s._v("<Topic>")]),s._v(" "),e("code",[s._v("<Action>")]),s._v(" "),e("code",[s._v("<Access>")])]),s._v(" "),e("p",[s._v("增加一条 clientid 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" clientid emqx_clientid Topic/A pub allow\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl aad username "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Topic>")]),s._v(" "),e("code",[s._v("<Action>")]),s._v(" "),e("code",[s._v("<Access>")])]),s._v(" "),e("p",[s._v("增加一条 username 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" username emqx_username Topic/B sub deny\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl aad "),e("code",[s._v("_all")]),s._v(" "),e("code",[s._v("<Topic>")]),s._v(" "),e("code",[s._v("<Action>")]),s._v(" "),e("code",[s._v("<Access>")])]),s._v(" "),e("p",[s._v("增加一条 $all 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" _all Topic/C pubsub allow\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h4",{attrs:{id:"acl-del"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#acl-del"}},[s._v("#")]),s._v(" acl del")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("acl del clientid "),e("code",[s._v("<Clientid>")]),s._v(" "),e("code",[s._v("<Topic>")])]),s._v(" "),e("p",[s._v("删除一条 clientid 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl del clientid emqx_clientid Topic/A\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl del username "),e("code",[s._v("<Username>")]),s._v(" "),e("code",[s._v("<Topic>")])]),s._v(" "),e("p",[s._v("删除一条 username 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl del clientid emqx_username Topic/B\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("acl del "),e("code",[s._v("_all")]),s._v(" "),e("code",[s._v("<Topic>")])]),s._v(" "),e("p",[s._v("删除一条 $all 的 ACL 规则")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("./bin/emqx_ctl acl del _all Topic/C\nok\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"pem-cache-命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pem-cache-命令"}},[s._v("#")]),s._v(" pem_cache 命令")]),s._v(" "),e("p",[e("code",[s._v("pem_cache")]),s._v(" 命令用于清理所有 PEM 证书的缓存。例如，在替换了 SSL 监听器的证书\n文件后，你可以使用该命令让新的证书文件生效，而不是重启 EMQX 的 SSL 监听器。")]),s._v(" "),e("table",[e("thead",[e("tr",[e("th",[s._v("命令")]),s._v(" "),e("th",[s._v("描述")])])]),s._v(" "),e("tbody",[e("tr",[e("td",[e("code",[s._v("pem_cache clean")])]),s._v(" "),e("td",[s._v("清理所有节点的 x509 的证书缓存")])]),s._v(" "),e("tr",[e("td",[e("code",[s._v("pem_cache clean node <Node>")])]),s._v(" "),e("td",[s._v("清理指定节点的 x509 的证书缓存")])])])]),s._v(" "),e("p",[e("strong",[s._v("注：")]),s._v(" 更新证书并不会影响当前已建立的 TLS 连接。")]),s._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),e("p",[s._v("该命令在 v4.3.13 版本中引入。在这之前都版本都不支持该命令")])])])}),[],!1,null,null,null);a.default=n.exports},959:function(s,a,t){s.exports=t.p+"docs-assets/img/rule_metrics.b093843b.png"},960:function(s,a,t){s.exports=t.p+"docs-assets/img/action_metrics.4b791935.png"},961:function(s,a,t){s.exports=t.p+"docs-assets/img/resource_status.22036231.png"}}]);