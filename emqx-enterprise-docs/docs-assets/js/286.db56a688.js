(window.webpackJsonp=window.webpackJsonp||[]).push([[286],{1563:function(e,s,t){"use strict";t.r(s);var a=t(10),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"install-emqx-cluster-with-emqx-operator"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#install-emqx-cluster-with-emqx-operator"}},[e._v("#")]),e._v(" Install EMQX Cluster with EMQX Operator")]),e._v(" "),t("p",[e._v("For more information about latest EMQX Operator, please access "),t("a",{attrs:{href:"https://github.com/emqx/emqx-operator/blob/main/docs/en_US/getting-started/getting-started.md",target:"_blank",rel:"noopener noreferrer"}},[e._v("github"),t("OutboundLink")],1)]),e._v(" "),t("ol",[t("li",[t("p",[e._v("Use "),t("a",{attrs:{href:"https://github.com/cert-manager/cert-manager",target:"_blank",rel:"noopener noreferrer"}},[e._v("cert-manager"),t("OutboundLink")],1),e._v(" for provisioning the certificates for the webhook server. Please follow the "),t("a",{attrs:{href:"https://cert-manager.io/docs/installation/",target:"_blank",rel:"noopener noreferrer"}},[e._v("cert-manager documentation"),t("OutboundLink")],1),e._v(" to install it。")])]),e._v(" "),t("li",[t("p",[e._v("Install Operator Controller Manager service in one of the following ways：")]),e._v(" "),t("ul",[t("li",[e._v("Install with default static files")])]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -f -L "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://github.com/emqx/emqx-operator/releases/download/1.1.10/emqx-operator-controller.yaml"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply -f -\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[e._v("Install with Helm\n"),t("ul",[t("li",[e._v("Add the EMQX Helm repository")])])])]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("helm repo "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" emqx https://repos.emqx.io/charts \nhelm repo update\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("ul",[t("li",[e._v("Install EMQX Operator Controller by Helm")])]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ helm "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" emqx-operator emqx/emqx-operator "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(" \n--set "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("installCRDs")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(" \n--namespace emqx-operator-system "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(" \n--create-namespace\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("Check EMQX Operator Controller Status")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl get pods -l "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"control-plane=controller-manager"')]),e._v(" -n emqx-operator-system \nNAME READY STATUS RESTARTS AGE \nemqx-operator-controller-manager-68b866c8bf-kd4g6 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 15s\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br")])])])]),e._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[e._v("Deploy EMQX Enterprise")])]),e._v(" "),t("ul",[t("li",[t("p",[e._v("Deploy EMQX Enterprise Custom Resource")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<<")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"EOF"'),t("span",{pre:!0,attrs:{class:"token bash punctuation"}},[e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" kubectl apply -f -")]),e._v("\napiVersion: apps.emqx.io/v1beta2\nkind: EmqxEnterprise\nmetadata:\n  name: emqx-ee\nspec:\n  image: emqx/emqx-ee:4.3.6\nEOF")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("Check EMQX Enterprise status")]),e._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl get pods \nNAME READY STATUS RESTARTS AGE \nemqx-ee-0 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 22s \nemqx-ee-1 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 22s \nemqx-ee-2 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("/1 Running "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" 22s\n$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it emqx-ee-0 -- emqx_ctl status \nNode "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'emqx-ee@emqx-ee-0.emqx-ee-headless.default.svc.cluster.local'")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4.3")]),e._v(".6 is started\n$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it emqx-ee-0 -- emqx_ctl cluster status \nCluster status: "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#{running_nodes =>")]),e._v("\n                   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'emqx-ee@emqx-ee-0.emqx-ee-headless.default.svc.cluster.local'")]),e._v(",\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'emqx-ee@emqx-ee-1.emqx-ee-headless.default.svc.cluster.local'")]),e._v(",\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'emqx-ee@emqx-ee-2.emqx-ee-headless.default.svc.cluster.local'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(",\n               stopped_nodes "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br")])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);