(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{1617:function(s,t,e){"use strict";e.r(t);var a=e(10),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"bridge-data-to-mqtt-broker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bridge-data-to-mqtt-broker"}},[s._v("#")]),s._v(" Bridge data to MQTT Broker")]),s._v(" "),a("p",[s._v("Setup another MQTT broker using mosquitto, change the port to 2883.\nTaking Mac OSX for instance:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ brew "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mosquitto\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/local/etc/mosquitto/mosquitto.conf\n\nport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2883")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# start mosquitto")]),s._v("\n$ brew services start mosquitto\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("Create a rule:")]),s._v(" "),a("p",[s._v("Go to "),a("a",{attrs:{href:"http://127.0.0.1:18083/#/rules",target:"_blank",rel:"noopener noreferrer"}},[s._v("EMQX Dashboard"),a("OutboundLink")],1),s._v(', select the\n"rule" tab on the menu to the left.')]),s._v(" "),a("p",[s._v('Select "message.publish", then type in the following SQL:')]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message.publish"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:e(393),alt:"image"}})]),s._v(" "),a("p",[s._v("Bind an action:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('Click on the "+ Add" button under "Action Handler", and then select\n"Data bridge to MQTT Broker" in the pop-up dialog window.\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:e(406),alt:"image"}})]),s._v(" "),a("p",[s._v('Bind a resource to the action. Since the dropdown list "Resource" is\nempty for now, we create a new resource by clicking on the "New\nResource" to the top right, and then select "MQTT Bridge":')]),s._v(" "),a("p",[a("img",{attrs:{src:e(407),alt:"image"}})]),s._v(" "),a("p",[s._v("Configure the resource:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('Set "Broker Address" to the address of mosquitto, here is\n127.0.0.1:2883, and keep all other configs as default, and click on\nthe "Testing Connection" button to make sure the connection can be\ncreated successfully, and then click on the "Create" button.\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("img",{attrs:{src:e(771),alt:"image"}})]),s._v(" "),a("p",[s._v('Back to the "Actions" dialog, and then click on the "Confirm"\nbutton.')]),s._v(" "),a("p",[a("img",{attrs:{src:e(772),alt:"image"}})]),s._v(" "),a("p",[s._v('Back to the creating rule page, then click on "Create" button. The\nrule we created will be show in the rule list:')]),s._v(" "),a("p",[a("img",{attrs:{src:e(447),alt:"image"}})]),s._v(" "),a("p",[s._v("We have finished, testing the rule by sending an MQTT message to\nemqx:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Topic: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"t/1"')]),s._v("\n\nQoS: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\nRetained: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n\nPayload: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello, World\\!"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("Then verify a message has been published to mosquitto:")]),s._v(" "),a("p",[a("img",{attrs:{src:e(408),alt:"image"}})]),s._v(" "),a("p",[s._v('And from the rule list, verify that the "Matched" column has increased\nto 1:')]),s._v(" "),a("p",[a("img",{attrs:{src:e(447),alt:"image"}})])])}),[],!1,null,null,null);t.default=n.exports},393:function(s,t,e){s.exports=e.p+"docs-assets/img/mysql_sql_1.515176ea.png"},406:function(s,t,e){s.exports=e.p+"docs-assets/img/mqtt_action_0.a65b4228.png"},407:function(s,t,e){s.exports=e.p+"docs-assets/img/mqtt_action_1.4aa88837.png"},408:function(s,t,e){s.exports=e.p+"docs-assets/img/rpc_result.ec735ad9.png"},447:function(s,t,e){s.exports=e.p+"docs-assets/img/mqtt_rule_overview_0.e2148c37.png"},771:function(s,t,e){s.exports=e.p+"docs-assets/img/mqtt_resource_0.92c769d2.png"},772:function(s,t,e){s.exports=e.p+"docs-assets/img/mqtt_action_2.31434f29.png"}}]);