(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1104:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer1.20e3ab96.png"},1105:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer3.0771f705.png"},1106:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer4.d17dd7ce.png"},1107:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer5.afd84e03.png"},1108:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer6.1266de01.png"},1109:function(s,a,r){s.exports=r.p+"docs-assets/img/pulsar_consumer7.56ccae7a.png"},1783:function(s,a,r){"use strict";r.r(a);var t=r(10),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"pulsar-消费组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pulsar-消费组"}},[s._v("#")]),s._v(" Pulsar 消费组")]),s._v(" "),t("p",[s._v("Pulsar 消费组使用外部 Pulsar 作为消息队列，可以从 Pulsar 中消费消息转换成为 MQTT 消息发布在 emqx 中。")]),s._v(" "),t("p",[s._v("搭建 Pulsar 环境，以 MacOS X 为例:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://archive.apache.org/dist/pulsar/pulsar-2.3.2/apache-pulsar-2.3.2-bin.tar.gz\n\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xvfz apache-pulsar-2.3.2-bin.tar.gz\n\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" apache-pulsar-2.3.2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 Pulsar")]),s._v("\n$ ./bin/pulsar standalone\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("创建 Pulsar 的主题:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ./bin/pulsar-admin topics create-partitioned-topic -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" testTopic\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"创建模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建模块"}},[s._v("#")]),s._v(" 创建模块")]),s._v(" "),t("p",[s._v("打开 "),t("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("EMQX Dashboard"),t("OutboundLink")],1),s._v("，点击左侧的 “模块” 选项卡，选择添加：")]),s._v(" "),t("p",[t("img",{attrs:{src:r(390),alt:"image-20200927213049265"}})]),s._v(" "),t("p",[s._v("选择 Pulsar 消费组模块:")]),s._v(" "),t("p",[t("img",{attrs:{src:r(1104),alt:""}})]),s._v(" "),t("p",[s._v("填写相关参数:")]),s._v(" "),t("p",[t("img",{attrs:{src:r(1105),alt:""}})]),s._v(" "),t("p",[s._v("1). Pulsar 服务器地址")]),s._v(" "),t("p",[s._v("2). Pulsar consumer 进程数量")]),s._v(" "),t("p",[s._v("3). Pulsar 的订阅主题")]),s._v(" "),t("p",[s._v("4). MQTT 的消息主题")]),s._v(" "),t("p",[s._v("5). MQTT 的主题服务质量")]),s._v(" "),t("p",[s._v("6). Pulsar 流控阈值 (Pulsar 流控阈值，配置 Pulsar 向消费者发送多少条消息后阻塞 Pulsar Consumer)")]),s._v(" "),t("p",[s._v("7). EMQX 重置流控阈值百分比 (Pulsar 流控阈值重置百分比。此配置让消费者处理完成一定数量的消息之后，提前重置 "),t("code",[s._v("Pulsar 流控阈值")]),s._v("。 比如，"),t("code",[s._v("Pulsar 流控阈值")]),s._v(" 为 1000，"),t("code",[s._v("阈值重置百分比")]),s._v(" 为 80%，则重置)")]),s._v(" "),t("p",[s._v("点击添加后，模块添加完成:")]),s._v(" "),t("p",[t("img",{attrs:{src:r(1106),alt:""}})]),s._v(" "),t("p",[s._v('资源已经创建完成，现在用Dashboard的websocket工具订阅MQTT的主题 "TestTopic":')]),s._v(" "),t("p",[t("img",{attrs:{src:r(1107),alt:""}})]),s._v(" "),t("p",[s._v("使用pulsar-cli 生产一条消息:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bin/pulsar-client produce TestTopic --messages "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello-pulsar"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:r(1108),alt:""}})]),s._v(" "),t("p",[s._v('Dashboard的websocket工具接收到了pulsar 生产的消息"hello-pulsar":')]),s._v(" "),t("p",[t("img",{attrs:{src:r(1109),alt:""}})])])}),[],!1,null,null,null);a.default=e.exports},390:function(s,a,r){s.exports=r.p+"docs-assets/img/modules.89e07c9c.png"}}]);