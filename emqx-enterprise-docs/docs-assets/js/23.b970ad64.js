(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1626:function(s,e,t){"use strict";t.r(e);var n=t(10),a=Object(n.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"get-subscription-relationship-from-redis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#get-subscription-relationship-from-redis"}},[s._v("#")]),s._v(" Get subscription relationship from  Redis")]),s._v(" "),n("p",[s._v("Set up the Redis environment, and take MacOS X as an example:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" $ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-4.0.14.tar.gz\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-4.0.14.tar.gz\n$ "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-4.0.14\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Start redis")]),s._v("\n$ redis-server\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("Create rules:")]),s._v(" "),n("p",[s._v("Open "),n("a",{attrs:{href:"http://127.0.0.1:18083/#/rules",target:"_blank",rel:"noopener noreferrer"}},[s._v("EMQX Dashboard"),n("OutboundLink")],1),s._v(' and select the "Rules" tab on the left.')]),s._v(" "),n("p",[s._v("Then fill in the rule SQL:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("SELECT * FROM "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$events")]),s._v('/client_connected"')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:t(844),alt:""}})]),s._v(" "),n("p",[s._v("Related actions:")]),s._v(" "),n("p",[s._v('Select "Add Action" on the "Response Action" interface, and then select "Get Subscription List from Redis" in the "Add Action" drop-down box.')]),s._v(" "),n("p",[n("img",{attrs:{src:t(845),alt:""}})]),s._v(" "),n("p",[s._v("Fill in the action parameters:")]),s._v(" "),n("p",[s._v('The action of "Get subscription list from Redis" requires one parameter:')]),s._v(" "),n("p",[s._v('1). Associated resources. The resource drop-down box is empty now, and you can click "New" in the upper right corner to create a Redis resource:')]),s._v(" "),n("p",[n("img",{attrs:{src:t(846),alt:""}})]),s._v(" "),n("p",[s._v('Select "Redis single-node mode resources".')]),s._v(" "),n("p",[n("img",{attrs:{src:t(409),alt:""}})]),s._v(" "),n("p",[s._v("Fill in the resource configuration:")]),s._v(" "),n("p",[s._v('Fill in the real Redis server address and keep other configurations at default values. Then, click the "Test Connection" button to ensure that the connection test is successful.')]),s._v(" "),n("p",[s._v('Finally click the "Create" button.')]),s._v(" "),n("p",[n("img",{attrs:{src:t(847),alt:""}})]),s._v(" "),n("p",[s._v('Return to the response action interface and click "OK".')]),s._v(" "),n("p",[n("img",{attrs:{src:t(848),alt:""}})]),s._v(" "),n("p",[s._v('Return to the rule creation interface and click "Create".')]),s._v(" "),n("p",[n("img",{attrs:{src:t(849),alt:""}})]),s._v(" "),n("p",[s._v("The rule has been created, and you can insert a subscription relationship into Redis through  Redis CLI:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("HSET mqtt:sub:test t1 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:t(850),alt:""}})]),s._v(" "),n("p",[s._v("Log in to the device whose clientid is test via Dashboard:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(851),alt:""}})]),s._v(" "),n("p",[s._v("Check the subscription list, and you can see that the "),n("strong",[s._v("test")]),s._v(" device has subscribed to the "),n("strong",[s._v("t1")]),s._v(" topic:")]),s._v(" "),n("p",[n("img",{attrs:{src:t(852),alt:""}})])])}),[],!1,null,null,null);e.default=a.exports},409:function(s,e,t){s.exports=t.p+"docs-assets/img/offline_msg_4.170b2bfe.png"},844:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_1.d96ce5c5.png"},845:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_2.54beeaf4.png"},846:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_3.c4b4359b.png"},847:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_5.234638dd.png"},848:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_6.8f947a8e.png"},849:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_7.31e31cbb.png"},850:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_8.dee87056.png"},851:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_9.32f326d9.png"},852:function(s,e,t){s.exports=t.p+"docs-assets/img/redis_sub_10.9f25e956.png"}}]);