(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{1049:function(t,e,s){t.exports=s.p+"docs-assets/img/auth_jwt1.830a8cdc.png"},1050:function(t,e,s){t.exports=s.p+"docs-assets/img/auth_jwt2.d4ca7512.png"},1051:function(t,e,s){t.exports=s.p+"docs-assets/img/auth_jwt3.18298e50.png"},1052:function(t,e,s){t.exports=s.p+"docs-assets/img/auth_jwt4.4b85bf28.png"},1768:function(t,e,s){"use strict";s.r(e);var a=s(10),_=Object(a.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"jwt-认证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jwt-认证"}},[t._v("#")]),t._v(" JWT 认证")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://JWT.io/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JWT"),a("OutboundLink")],1),t._v(" 认证是基于 Token 的鉴权机制，不依赖服务端保留客户端的认证信息或者会话信息，在持有密钥的情况下可以批量签发认证信息，是最简便的认证方式。")]),t._v(" "),a("h2",{attrs:{id:"创建模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建模块"}},[t._v("#")]),t._v(" 创建模块")]),t._v(" "),a("p",[t._v("打开 "),a("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("EMQX Dashboard"),a("OutboundLink")],1),t._v("，点击左侧的“模块”选项卡，选择“添加模块”：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(1049),alt:"Modules"}})]),t._v(" "),a("p",[t._v("然后选择“认证鉴权”下的“JWT 认证”：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(1050),alt:"Modules JWT Selected"}})]),t._v(" "),a("p",[t._v("JWT 认证提供了以下配置项：")]),t._v(" "),a("ol",[a("li",[t._v("认证来源：客户端连接时存放 JWT 的字段，目前支持选择 username 或 password。")]),t._v(" "),a("li",[t._v("密钥：签发 JWT 时使用的密钥。这里将用于验证 EMQX 收到的 JWT 是否合法，适用于 HMAC 算法签发的 JWT。")]),t._v(" "),a("li",[t._v("公钥文件：将用于验证 EMQX 收到的 JWT 是否合法，适用于 RSA 或 ECDSA 算法签发的 JWT。")]),t._v(" "),a("li",[t._v("JWKS 服务器地址：EMQX 将从 JWKS 服务器定期查询最新的公钥列表，并用于验证收到的 JWT 是否合法，适用于 RSA 或 ECDSA 算法签发的 JWT。")]),t._v(" "),a("li",[t._v("验证声明字段：是否需要验证 JWT Payload 中的声明与“声明字段列表”一致。")]),t._v(" "),a("li",[t._v("声明字段列表：用于验证 JWT Payload 中的声明是否合法。最常见的用法是，添加一个键为 "),a("code",[t._v("username")]),t._v(" 值为 "),a("code",[t._v("%u")]),t._v(" 的键值对，"),a("code",[t._v("%u")]),t._v(" 作为占位符将在运行时被替换为客户端实际连接时使用的 Username，替换后的值将被用于与 JWT Payload 的同键声明的值比较，以起到 JWT 与 Username 一一对应的效果。声明字段列表中目前支持以下两种占位符：\n"),a("ol",[a("li",[a("code",[t._v("%u")]),t._v("：将在运行时被替换为客户端连接时使用的 Username。")]),t._v(" "),a("li",[a("code",[t._v("%c")]),t._v("：将在运行时被替换为客户端连接时使用的 Client ID。")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：EMQX 会按照 "),a("code",[t._v("Secret")]),t._v("、"),a("code",[t._v("Pubkey")]),t._v(" 和 "),a("code",[t._v("JWKs Addr")]),t._v(" 的固定顺序验证 JWT。没有配置的字段将被忽略。")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(1051),alt:"JWT Module Settings"}})]),t._v(" "),a("p",[t._v("配置完成后点击“添加”按钮即可成功添加 JWT 认证模块。")]),t._v(" "),a("p",[a("img",{attrs:{src:s(1052),alt:"Modules JWT Added"}})]),t._v(" "),a("h2",{attrs:{id:"认证原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#认证原理"}},[t._v("#")]),t._v(" 认证原理")]),t._v(" "),a("p",[t._v("客户端使用用户名或密码字段携带 JWT（取决于模块配置），发起连接时 EMQX 使用配置中的密钥、证书进行解密，如果能成功解密则认证成功，否则认证失败。")]),t._v(" "),a("p",[t._v("默认配置下启用 JWT 认证后，你可以通过任意用户名+以下密码进行连接：")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7ImF1dGhvciI6IndpdndpdiIsInNpdGUiOiJodHRwczovL3dpdndpdi5jb20ifSwiZXhwIjoxNTgyMjU1MzYwNjQyMDAwMCwiaWF0IjoxNTgyMjU1MzYwfQ.FdyAx2fYahm6h3g47m88ttyINzptzKy_speimyUcma4\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("上述JWT Token仅做测试使用，可根据自己的业务需求用相关工具生成。此处提供一个在线生成工具：https://www.jsonwebtoken.io/。")])])])}),[],!1,null,null,null);e.default=_.exports}}]);