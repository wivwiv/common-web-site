(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{1709:function(s,a,t){"use strict";t.r(a);var n=t(10),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"kafka-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-桥接"}},[s._v("#")]),s._v(" Kafka 桥接")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("EMQX 3.1 版本后推出强大的规则引擎用于替换插件，建议您前往使用"),n("RouterLink",{attrs:{to:"/zh/enterprise/latest/rule/bridge_kafka.html"}},[s._v("Kafka 桥接")])],1)]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 Kafka 集群，Apache Kafka是一个快速、高可扩展、高吞吐的分布式日志系统，配合kafka Stream，在流式数据处理中非常常用。")]),s._v(" "),n("p",[n("img",{attrs:{src:t(413),alt:"image"}})]),s._v(" "),n("p",[s._v("Kafka 桥接插件配置文件: etc/plugins/emqx_bridge_kafka.conf。")]),s._v(" "),n("h2",{attrs:{id:"配置-kafka-集群地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-kafka-集群地址"}},[s._v("#")]),s._v(" 配置 Kafka 集群地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Kafka 服务器地址")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.servers = 127.0.0.1:9092,127.0.0.2:9092,127.0.0.3:9092")]),s._v("\nbridge.kafka.servers "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Kafka 分区策略。可选值: per_partition | per_broker")]),s._v("\nbridge.kafka.connection_strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" per_partition\n\nbridge.kafka.min_metadata_refresh_interval "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 5S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Produce 写类型。可选值: sync | async")]),s._v("\nbridge.kafka.produce "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n\nbridge.kafka.produce.sync_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 3S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 指定 replayq 在磁盘上存储消息的基本目录。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 如果该配置项缺失活着设置为 undefined, replayq 将以使用内存的")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 的方式工作。也就是说，消息不在磁盘上排队 -- 在这种情况下，send")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 和 send_async API 的调用者负责处理在应用程序、网络或 kafka")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 干扰时可能丢失的消息。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.replayq_dir = /tmp/emqx_bridge_kafka/")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default=10MB, replayq 分段大小。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.producer.replayq_seg_bytes = 10MB")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## producer required_acks. 可选值: all_isr | leader_only | none.")]),s._v("\nbridge.kafka.producer.required_acks "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" none\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## default=10000. leader 在回复 producer 前等待副本的超时时间。")]),s._v("\nbridge.kafka.producer.ack_timeout "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 10S\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 收集到一次 produce 请求中的最大字节数")]),s._v("\nbridge.kafka.producer.max_batch_bytes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1024KB\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 收集到一次 produce 请求中的最少字节数")]),s._v("\nbridge.kafka.producer.min_batch_bytes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 在没有接收到上次请求的 ack 的情况下，可以提前发送的 batch 数。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 如果消息必须严格按照顺序传递，则必须为0。")]),s._v("\nbridge.kafka.producer.max_send_ahead "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 默认为无压缩")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.producer.compression = no_compression")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 默认值为 base64, 可选值: base64 | plain")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.encode_payload_type = base64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.buffer = 32KB")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.recbuf = 32KB")]),s._v("\nbridge.kafka.sock.sndbuf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1MB\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## bridge.kafka.sock.read_packets = 20")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("h2",{attrs:{id:"配置-kafka-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-kafka-桥接规则"}},[s._v("#")]),s._v(" 配置 Kafka 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge Kafka Hooks")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${topic}: the kafka topics to which the messages will be published.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## ${filter}: the mqtt topic (may contain wildcard) on which the action will be performed.")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Connected Record Hook")]),s._v("\nbridge.kafka.hook.client.connected.1     "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Client Disconnected Record Hook")]),s._v("\nbridge.kafka.hook.client.disconnected.1  "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Subscribed Record Hook")]),s._v("\nbridge.kafka.hook.session.subscribed.1   "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_subscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Session Unsubscribed Record Hook")]),s._v("\nbridge.kafka.hook.session.unsubscribed.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"session_unsubscribed"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Publish Record Hook")]),s._v("\nbridge.kafka.hook.message.publish.1      "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_publish"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Delivered Record Hook")]),s._v("\nbridge.kafka.hook.message.delivered.1    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_delivered"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Message Acked Record Hook")]),s._v("\nbridge.kafka.hook.message.acked.1        "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"filter"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(",  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message_acked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## More Configures")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## partitioner strategy:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option:  random | roundrobin | first_key_dispatch")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "strategy":"random"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## key:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: ${clientid} | ${username}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "key":"${clientid}"}')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## format:")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Option: json | json")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('## Example: bridge.kafka.hook.message.publish.1 = {"filter":"#", "topic":"message_publish", "format":"json"}')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br")])]),n("h2",{attrs:{id:"kafka-桥接规则说明"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-桥接规则说明"}},[s._v("#")]),s._v(" Kafka 桥接规则说明")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("事件")]),s._v(" "),n("th",[s._v("说明")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("bridge.kafka.hook.client.connected.1")]),s._v(" "),n("td",[s._v("客户端登录")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.client.disconnected.1")]),s._v(" "),n("td",[s._v("客户端退出")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.session.subscribed.1")]),s._v(" "),n("td",[s._v("订阅主题")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.session.unsubscribed.1")]),s._v(" "),n("td",[s._v("取消订阅主题")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.publish.1")]),s._v(" "),n("td",[s._v("发布消息")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.delivered.1")]),s._v(" "),n("td",[s._v("delivered 消息")])]),s._v(" "),n("tr",[n("td",[s._v("bridge.kafka.hook.message.acked.1")]),s._v(" "),n("td",[s._v("ACK 消息")])])])]),s._v(" "),n("h2",{attrs:{id:"客户端上下线事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端上下线事件转发-kafka"}},[s._v("#")]),s._v(" 客户端上下线事件转发 Kafka")]),s._v(" "),n("p",[s._v("设备上线 EMQX 转发上线事件消息到 Kafka:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_connected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("设备下线 EMQX 转发下线事件消息到 Kafka:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_disconnected"')]),s._v(",\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"reason"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${reason}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ts}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"客户端订阅主题事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-kafka"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_subscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"客户端取消订阅主题事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅主题事件转发-kafka"}},[s._v("#")]),s._v(" 客户端取消订阅主题事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" session_unsubscribed\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h2",{attrs:{id:"mqtt-消息转发到-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发到-kafka"}},[s._v("#")]),s._v(" MQTT 消息转发到 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_publish\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"mqtt-消息派发-deliver-事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息派发-deliver-事件转发-kafka"}},[s._v("#")]),s._v(" MQTT 消息派发 (Deliver) 事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_delivered\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"mqtt-消息确认-ack-事件转发-kafka"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-kafka"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 Kafka")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" message_acked\n\nvalue "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"client_id"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${clientid}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${username}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"from"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${fromClientId}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${topic}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"payload"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${payload}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"qos"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${qos}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${node}")]),s._v(",\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ts"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${timestamp}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"kafka-消费示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#kafka-消费示例"}},[s._v("#")]),s._v(" Kafka 消费示例")]),s._v(" "),n("p",[s._v("Kafka 读取 MQTT 客户端上下线事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic client_connected --from-beginning\n    \nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic client_disconnected --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 主题订阅事件消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic session_subscribed --from-beginning\n\nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic session_unsubscribed --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 发布消息:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_publish --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Kafka 读取 MQTT 消息发布 (Deliver)、确认 (Ack)事件:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("kafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_delivered --from-beginning\n\nkafka-console-consumer.sh --bootstrap-server "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:9092 --topic message_acked --from-beginning\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("默认 payload 被 base64 编码，可通过修改配置 bridge.kafka.encode_payload_type 指定\npayload 数据格式。")])]),s._v(" "),n("h2",{attrs:{id:"启用-kafka-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-kafka-桥接插件"}},[s._v("#")]),s._v(" 启用 Kafka 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_kafka\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports},413:function(s,a,t){s.exports=t.p+"docs-assets/img/bridge_kafka.ce57abe1.png"}}]);