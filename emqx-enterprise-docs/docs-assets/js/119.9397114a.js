(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{1575:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"ldap-authentication-acl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ldap-authentication-acl"}},[s._v("#")]),s._v(" LDAP Authentication/ACL")]),s._v(" "),n("p",[s._v("LDAP authentication/access control uses an external OpenLDAP server as the authentication data source, which can store large amounts of data and facilitate integration with external device management systems.")]),s._v(" "),n("h2",{attrs:{id:"create-module"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#create-module"}},[s._v("#")]),s._v(" Create module")]),s._v(" "),n("p",[s._v("Open "),n("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("EMQX Dashboard"),n("OutboundLink")],1),s._v(', click the "Modules" tab on the left, and choose to add:')]),s._v(" "),n("p",[n("img",{attrs:{src:a(391),alt:"image-20200928161310952"}})]),s._v(" "),n("p",[s._v("Select LDAP authentication/access control module")]),s._v(" "),n("p",[n("img",{attrs:{src:a(570),alt:"image-20200928144927769"}})]),s._v(" "),n("p",[s._v("Configure OpenLDAP related parameters")]),s._v(" "),n("p",[n("img",{attrs:{src:a(571),alt:"image-20200928144945076"}})]),s._v(" "),n("p",[s._v('Finally, click the "Add" button, the module can be added successfully:')]),s._v(" "),n("p",[n("img",{attrs:{src:a(572),alt:"image-20200928145033628"}})]),s._v(" "),n("h2",{attrs:{id:"ldap-schema"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ldap-schema"}},[s._v("#")]),s._v(" LDAP Schema")]),s._v(" "),n("p",[s._v("The data model needs to be configured in the LDAP schema directory. The data model in the default configuration is as follows:")]),s._v(" "),n("p",[n("strong",[s._v("/etc/openldap/schema/emqx.schema")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("attributetype "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),s._v(".6.1.4.1.11.2.53.2.2.3.1.2.3.1.3 NAME"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'isEnabled'")]),s._v("\nEQUALITY booleanMatch\nSYNTAX "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),s._v(".6.1.4.1.1466.115.121.1.7\nSINGLE-VALUE\nUSAGE userApplications"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nattributetype "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.3")]),s._v(".6.1.4.1.11.2.53.2.2.3.1.2.3.4.1 NAME "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mqttPublishTopic'")]),s._v("'mpt"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("')\nEQUALITY caseIgnoreMatch\nSUBSTR caseIgnoreSubstringsMatch\nSYNTAX 1.3.6.1.4.1.1466.115.121.1.15\nUSAGE userApplications)\nattributetype (1.3.6.1.4.1.11.2.53.2.2.3.1.2.3.4.2 NAME ('")]),s._v("mqttSubscriptionTopic"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("mst"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("')\nEQUALITY caseIgnoreMatch\nSUBSTR caseIgnoreSubstringsMatch\nSYNTAX 1.3.6.1.4.1.1466.115.121.1.15\nUSAGE userApplications)\nattributetype (1.3.6.1.4.1.11.2.53.2.2.3.1.2.3.4.3 NAME ('")]),s._v("mqttPubSubTopic"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("mpst"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("')\nEQUALITY caseIgnoreMatch\nSUBSTR caseIgnoreSubstringsMatch\nSYNTAX 1.3.6.1.4.1.1466.115.121.1.15\nUSAGE userApplications)\n\nobjectclass (1.3.6.1.4.1.11.2.53.2.2.3.1.2.3.4 NAME'")]),s._v("mqttUser"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nAUXILIARY\nMAY (mqttPublishTopic $ mqttSubscriptionTopic $ mqttPubSubTopic))\n\nobjectclass (1.3.6.1.4.1.11.2.53.2.2.3.1.2.3.2 NAME'")]),s._v("mqttDevice"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\nSUP top\nSTRUCTURAL\nMUST (uid)\nMAY (isEnabled))\n\nobjectclass (1.3.6.1.4.1.11.2.53.2.2.3.1.2.3.3 NAME'")]),s._v("mqttSecurity'\nSUP "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("\nAUXILIARY\nMAY "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userPassword $ userPKCS12 $ pwdAttribute $ pwdLockout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br")])]),n("p",[s._v("Edit the ldap configuration file slapd.conf to reference the Schema:")]),s._v(" "),n("p",[n("strong",[s._v("/etc/openldap/slapd.conf")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("include /etc/openldap/schema/core.schema\ninclude /etc/openldap/schema/cosine.schema\ninclude /etc/openldap/schema/inetorgperson.schema\ninclude /etc/openldap/schema/ppolicy.schema\ninclude /etc/openldap/schema/emqx.schema\n\ndatabase bdb\nsuffix "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dc=emqx,dc=io"')]),s._v("\nrootdn "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cn=root,dc=emqx,dc=io"')]),s._v("\nrootpw "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("SSHA"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("eoF7NhNrejVYYyGHqnt+MdKNBh4r1w3W\n\ndirectory /etc/openldap/data\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("The sample data in the default configuration is as follows:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("## create emqx.io\n\ndn:dc=emqx,dc=io\nobjectclass: top\nobjectclass: dcobject\nobjectclass: organization\ndc:emqx\no: emqx, Inc.\n\n# create testdevice.emqx.io\ndn:ou=testdevice,dc=emqx,dc=io\nobjectClass: top\nobjectclass:organizationalUnit\nou:testdevice\n\ndn:uid=mqttuser0001,ou=testdevice,dc=emqx,dc=io\nobjectClass: top\nobjectClass: mqttUser\nobjectClass: mqttDevice\nobjectClass: mqttSecurity\nuid: mqttuser0001\nisEnabled: TRUE\nmqttAccountName: user1\nmqttPublishTopic: mqttuser0001/pub/1\nmqttSubscriptionTopic: mqttuser0001/sub/1\nmqttPubSubTopic: mqttuser0001/pubsub/1\nuserPassword:: e1NIQX1tbGIzZmF0NDBNS0JUWFVWWndDS21MNzNSLzA9\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("p",[s._v("After enabling LDAP authentication, you can connect via username: mqttuser0001 and password: public.")]),s._v(" "),n("h2",{attrs:{id:"ldap-access-control-configuration-method"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ldap-access-control-configuration-method"}},[s._v("#")]),s._v(" LDAP access control configuration method")]),s._v(" "),n("p",[n("code",[s._v("mqttPublishTopic")]),s._v(" allowed topics to be published (multiple can be configured)")]),s._v(" "),n("p",[n("code",[s._v("mqttSubscriptionTopic")]),s._v(" allows to subscribe to the topic (multiple can be configured)")]),s._v(" "),n("p",[n("code",[s._v("mqttPubSubTopic")]),s._v(" allows to subscribe/publish the topic (multiple can be configured)")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),n("p",[s._v("The current version only supports OpenLDAP, not Microsoft Active Directory.")])])])}),[],!1,null,null,null);t.default=e.exports},391:function(s,t,a){s.exports=a.p+"docs-assets/img/modules.1814040c.png"},570:function(s,t,a){s.exports=a.p+"docs-assets/img/auth_ldap1.58192685.png"},571:function(s,t,a){s.exports=a.p+"docs-assets/img/auth_ldap2.2cd2346f.png"},572:function(s,t,a){s.exports=a.p+"docs-assets/img/auth_ldap3.556f2417.png"}}]);