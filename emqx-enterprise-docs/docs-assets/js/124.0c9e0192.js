(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{1592:function(e,t,s){"use strict";s.r(t);var i=s(10),o=Object(i.a)({},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[i("h1",{attrs:{id:"mqtt-proxy-subscription"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-proxy-subscription"}},[e._v("#")]),e._v(" MQTT proxy subscription")]),e._v(" "),i("p",[e._v("The proxy subscription function of EMQX enables the client to automatically establish the user's preset subscription relationship without sending additional SUBSCRIBE messages when the connection is established.")]),e._v(" "),i("h2",{attrs:{id:"create-module"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#create-module"}},[e._v("#")]),e._v(" Create module")]),e._v(" "),i("p",[e._v("Open "),i("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[e._v("EMQX Dashboard"),i("OutboundLink")],1),e._v(', click the "Modules" tab on the left, and choose to add:')]),e._v(" "),i("p",[i("img",{attrs:{src:s(391),alt:"image-20200927213049265"}})]),e._v(" "),i("p",[e._v("Select MQTT broker subscription module")]),e._v(" "),i("p",[i("img",{attrs:{src:s(629),alt:"image-20200927213049265"}})]),e._v(" "),i("p",[e._v("Configure related parameters")]),e._v(" "),i("p",[i("img",{attrs:{src:s(630),alt:"image-20200927213049265"}})]),e._v(" "),i("p",[e._v("After clicking add, the module is added")]),e._v(" "),i("p",[i("img",{attrs:{src:s(631),alt:"image-20200927213049265"}})]),e._v(" "),i("h2",{attrs:{id:"subscription-options"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#subscription-options"}},[e._v("#")]),e._v(" Subscription options")]),e._v(" "),i("ul",[i("li",[i("p",[e._v("Quality of Service (QoS)")]),e._v(" "),i("p",[e._v("The maximum QoS level of application messages that the server can send to the client.")])]),e._v(" "),i("li",[i("p",[e._v("NL (No Local)")]),e._v(" "),i("p",[e._v("Whether application messages can be forwarded to the client that posted this message.")]),e._v(" "),i("p",[e._v("-When the NL value is 0, it means that the application message can be forwarded to the client that published the message.")]),e._v(" "),i("p",[e._v("-When the NL value is 1, it means that the application message cannot be forwarded to the client that published the message.")])]),e._v(" "),i("li",[i("p",[e._v("RAP (Retain As Published)")]),e._v(" "),i("p",[e._v("When forwarding application messages to this subscription, whether to keep the RETAIN flag set when the message is published.")]),e._v(" "),i("p",[e._v("-When the RAP value is 0, it means that the reserved flag is set to 0 when forwarding application messages to this subscription.")]),e._v(" "),i("p",[e._v("-When the RAP value is 1, it means to keep the reserved flag set when the message is published when the application message is forwarded to this subscription.")])]),e._v(" "),i("li",[i("p",[e._v("RH (Retain Handling)")]),e._v(" "),i("p",[e._v("Whether to send a hold message when the subscription is established")]),e._v(" "),i("p",[e._v("-0: Send a reserved message when the subscription is established")]),e._v(" "),i("p",[e._v("-1: When the subscription is established, if the subscription does not currently exist, a reserved message will be sent")]),e._v(" "),i("p",[e._v("-2: Do not send reserved messages when the subscription is established")])])]),e._v(" "),i("h2",{attrs:{id:"agent-subscription-rules"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#agent-subscription-rules"}},[e._v("#")]),e._v(" Agent subscription rules")]),e._v(" "),i("p",[e._v("When configuring the topic subscribed by the agent, EMQX provides two placeholders "),i("code",[e._v("%c")]),e._v(" and "),i("code",[e._v("%u")]),e._v(" for users to use. EMQX will configure the "),i("code",[e._v("%c")]),e._v(" and "),i("code",[e._v("%u")]),e._v(" "),i("code",[e._v("Replaced with the client's")]),e._v("Client ID"),i("code",[e._v("and ʻUsername")]),e._v(" respectively. It should be noted that "),i("code",[e._v("%c")]),e._v(" and "),i("code",[e._v("%u")]),e._v(" must occupy an entire topic level.")]),e._v(" "),i("p",[e._v("For example, after adding the rules in the above figure: configure two clients A and B, the "),i("code",[e._v("Client ID")]),e._v(" of client A is "),i("code",[e._v("testclientA")]),e._v(", the "),i("code",[e._v("Username")]),e._v(" is "),i("code",[e._v("testerA")]),e._v(", and the "),i("code",[e._v("Client ID")]),e._v(" of client B is "),i("code",[e._v("testclientB")]),e._v(", ʻUsername"),i("code",[e._v("is")]),e._v("testerB`.")]),e._v(" "),i("p",[e._v("The client A uses the MQTT V3.1.1 protocol to connect to EMQX. According to the above configuration rules, the proxy subscription function will actively help the client subscribe to the two "),i("code",[e._v("client/testclientA")]),e._v(" with QoS 1 and ʻuser/testerA` with QoS 2. For this topic, because the connection protocol is MQTT V3.1.1, No Local, Retain As Published, and Retain Handling in the configuration are not effective.")]),e._v(" "),i("p",[e._v("Client B uses the MQTT V5 protocol to connect to EMQX. According to the configuration rules above, the proxy subscription function will actively help the client to subscribe to the two topics "),i("code",[e._v("client/testclientB")]),e._v(" and ʻuser/testerB"),i("code",[e._v(", among which")]),e._v("client/testclientB"),i("code",[e._v("The subscription options are Qos = 1, No Local, Retain As Published, and Retain Handling are all 0; the subscription options of ʻuser/testerB")]),e._v(" are Qos = 2, No Local = 1, Retain As Published = 1 and Retain Handling = 1.")])])}),[],!1,null,null,null);t.default=o.exports},391:function(e,t,s){e.exports=s.p+"docs-assets/img/modules.1814040c.png"},629:function(e,t,s){e.exports=s.p+"docs-assets/img/mod_subscriptions_1.11bdc58d.png"},630:function(e,t,s){e.exports=s.p+"docs-assets/img/mod_subscriptions_2.a23747ac.png"},631:function(e,t,s){e.exports=s.p+"docs-assets/img/mod_subscriptions_3.c31a1e9d.png"}}]);