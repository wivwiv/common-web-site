(window.webpackJsonp=window.webpackJsonp||[]).push([[200],{1711:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"rabbitmq-桥接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-桥接"}},[s._v("#")]),s._v(" RabbitMQ 桥接")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("EMQX 3.1 版本后推出强大的规则引擎用于替换插件，建议您前往使用"),n("RouterLink",{attrs:{to:"/zh/enterprise/latest/rule/bridge_rabbitmq.html"}},[s._v("RabbitMQ 桥接")]),s._v("规则引擎中创建 RabbitMQ 桥接")],1)]),s._v(" "),n("p",[s._v("EMQX 桥接转发 MQTT 消息到 RabbitMQ 集群:")]),s._v(" "),n("p",[n("img",{attrs:{src:a(414),alt:"image"}})]),s._v(" "),n("p",[s._v("RabbitMQ 桥接插件配置文件: etc/plugins/emqx_bridge_rabbit.conf。")]),s._v(" "),n("h2",{attrs:{id:"配置-rabbitmq-桥接地址"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rabbitmq-桥接地址"}},[s._v("#")]),s._v(" 配置 RabbitMQ 桥接地址")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的服务器地址")]),s._v("\nbridge.rabbit.1.server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:5672\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的连接池大小")]),s._v("\nbridge.rabbit.1.pool_size "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的用户名")]),s._v("\nbridge.rabbit.1.username "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guest\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的密码")]),s._v("\nbridge.rabbit.1.password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" guest\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的虚拟 Host")]),s._v("\nbridge.rabbit.1.virtual_host "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## RabbitMQ 的心跳间隔")]),s._v("\nbridge.rabbit.1.heartbeat "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.server = 127.0.0.1:5672")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.pool_size = 8")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.username = guest")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.password = guest")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.virtual_host = /")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bridge.rabbit.2.heartbeat = 0")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("h2",{attrs:{id:"配置-rabbitmq-桥接规则"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置-rabbitmq-桥接规则"}},[s._v("#")]),s._v(" 配置 RabbitMQ 桥接规则")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Bridge Hooks")]),s._v("\nbridge.rabbit.hook.client.subscribe.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_client_subscribe"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct:emq.subscription"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.client.unsubscribe.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_client_unsubscribe"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"direct:emq.unsubscription"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.publish.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$SYS")]),s._v('/#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_publish"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.'),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys")]),s._v('"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.publish.2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_publish"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.pub"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbridge.rabbit.hook.message.acked.1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"#"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"action"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on_message_acked"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rabbit"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exchange"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"topic:emq.acked"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h2",{attrs:{id:"客户端订阅主题事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端订阅主题事件转发-rabbitmq"}},[s._v("#")]),s._v(" 客户端订阅主题事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" subscribe\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.subscription\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jsx:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, proplists:get_value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("qos, Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("- TopicTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"客户端取消订阅事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#客户端取消订阅事件转发-rabbitmq"}},[s._v("#")]),s._v(" 客户端取消订阅事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" unsubscribe\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.unsubscription\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jsx:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Topic "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Topic, _Opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("- TopicTable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(",\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"mqtt-消息转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息转发-rabbitmq"}},[s._v("#")]),s._v(" MQTT 消息转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" binary:replace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("binary:replace"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Topic, "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(","),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq."),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$sys")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" emq.pub\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-publish-qos"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", byte, Qos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-client-id"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, pub_from"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("From"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-publish-msgid"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, emqx_base62:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emqx-topic"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, Topic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Payload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"mqtt-消息确认-ack-事件转发-rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-消息确认-ack-事件转发-rabbitmq"}},[s._v("#")]),s._v(" MQTT 消息确认 (Ack) 事件转发 RabbitMQ")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("routing_key "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" puback\nexchange "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emq.acked\nheaders "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x-emq-msg-acked"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(", binary, ClientId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\npayload "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" emqx_base62:encode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"rabbitmq-订阅消费-mqtt-消息示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-订阅消费-mqtt-消息示例"}},[s._v("#")]),s._v(" RabbitMQ 订阅消费 MQTT 消息示例")]),s._v(" "),n("p",[s._v("Python RabbitMQ消费者代码示例:")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env python")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" pika\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" sys\n\nconnection "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pika"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("BlockingConnection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pika"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ConnectionParameters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nchannel "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" connection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("channel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exchange_declare"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exchange"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct:emq.subscription'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" exchange_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nresult "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" channel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue_declare"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exclusive"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nqueue_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("queue_bind"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exchange"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'direct:emq.subscription'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" queue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("queue_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" routing_key"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'subscribe'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" properties"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" [x] %r:%r"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("routing_key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("basic_consume"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" queue"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("queue_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" no_ack"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nchannel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start_consuming"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("其他语言 RabbitMQ 客户端代码示例:")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/rabbitmq/rabbitmq-tutorials",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/rabbitmq/rabbitmq-tutorials"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"启用-rabbitmq-桥接插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启用-rabbitmq-桥接插件"}},[s._v("#")]),s._v(" 启用 RabbitMQ 桥接插件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("./bin/emqx_ctl plugins load emqx_bridge_rabbit\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports},414:function(s,t,a){s.exports=a.p+"docs-assets/img/bridge_rabbit.cbb49156.png"}}]);