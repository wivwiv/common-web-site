(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1060:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer1.20e3ab96.png"},1061:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer3.fb99d580.png"},1062:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer4.e1d17fa8.png"},1063:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer5.afd84e03.png"},1064:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer6.f4fe2fc3.png"},1065:function(a,s,t){a.exports=t.p+"docs-assets/img/kafka_consumer7.787c6774.png"},1771:function(a,s,t){"use strict";t.r(s);var e=t(10),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"kafka-消费组"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kafka-消费组"}},[a._v("#")]),a._v(" Kafka 消费组")]),a._v(" "),e("p",[a._v("Kafka 消费组使用外部 Kafka 作为消息队列，可以从 Kafka 中消费消息转换成为 MQTT 消息发布在 emqx 中。")]),a._v(" "),e("p",[a._v("搭建 Kafka 环境，以 MacOS X 为例:")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://archive.apache.org/dist/kafka/2.8.0/kafka_2.13-2.8.0.tgz\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -xzf  kafka_2.13-2.8.0.tgz\n\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" kafka_2.13-2.8.0\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 Zookeeper")]),a._v("\n./bin/zookeeper-server-start.sh config/zookeeper.properties\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 Kafka")]),a._v("\n./bin/kafka-server-start.sh config/server.properties\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br"),e("span",{staticClass:"line-number"},[a._v("2")]),e("br"),e("span",{staticClass:"line-number"},[a._v("3")]),e("br"),e("span",{staticClass:"line-number"},[a._v("4")]),e("br"),e("span",{staticClass:"line-number"},[a._v("5")]),e("br"),e("span",{staticClass:"line-number"},[a._v("6")]),e("br"),e("span",{staticClass:"line-number"},[a._v("7")]),e("br"),e("span",{staticClass:"line-number"},[a._v("8")]),e("br"),e("span",{staticClass:"line-number"},[a._v("9")]),e("br"),e("span",{staticClass:"line-number"},[a._v("10")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),e("p",[a._v("Kafka 消费组不支持 Kafka0.9 以下版本")]),a._v(" "),e("p",[a._v("创建资源之前，需要提前创建 Kafka 主题，不然会提示错误")])]),a._v(" "),e("p",[a._v("创建 Kafka 的主题:")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("$ ./bin/kafka-topics.sh --zookeeper localhost:2181 --replication-factor "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" --partitions "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" --topic testTopic --create\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("h2",{attrs:{id:"创建模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建模块"}},[a._v("#")]),a._v(" 创建模块")]),a._v(" "),e("p",[a._v("打开 "),e("a",{attrs:{href:"http://127.0.0.1:18083/#/modules",target:"_blank",rel:"noopener noreferrer"}},[a._v("EMQX Dashboard"),e("OutboundLink")],1),a._v("，点击左侧的 “模块” 选项卡，选择添加：")]),a._v(" "),e("p",[e("img",{attrs:{src:t(390),alt:"image-20200927213049265"}})]),a._v(" "),e("p",[a._v("选择 Kafka 消费组模块:")]),a._v(" "),e("p",[e("img",{attrs:{src:t(1060),alt:""}})]),a._v(" "),e("p",[a._v("填写相关参数:")]),a._v(" "),e("p",[e("img",{attrs:{src:t(1061),alt:""}})]),a._v(" "),e("p",[a._v("1). Kafka 服务器地址")]),a._v(" "),e("p",[a._v("2). Kafka consumer 连接池大小")]),a._v(" "),e("p",[a._v("3). Kafka 的订阅主题")]),a._v(" "),e("p",[a._v("4). MQTT 的消息主题")]),a._v(" "),e("p",[a._v("5). MQTT 的主题服务质量")]),a._v(" "),e("p",[a._v("6). Kafka Max Bytes (每次从 Kafka 里消费消息的最大字节数)")]),a._v(" "),e("p",[a._v("7). Kafka Offset Reset Policy (重置Offset策略,reset_to_latest | reset_by_subdcriber)")]),a._v(" "),e("p",[a._v("7). Kafka consumer 是否重连")]),a._v(" "),e("p",[a._v("点击添加后，模块添加完成:")]),a._v(" "),e("p",[e("img",{attrs:{src:t(1062),alt:""}})]),a._v(" "),e("p",[a._v('资源已经创建完成，现在用Dashboard的websocket工具订阅MQTT的主题 "TestTopic":')]),a._v(" "),e("p",[e("img",{attrs:{src:t(1063),alt:""}})]),a._v(" "),e("p",[a._v("使用kafka 命令行 生产一条消息:")]),a._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[a._v("./bin/kafka-console-producer.sh --broker-list localhost:9092 --topic TestTopic\n")])]),a._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[a._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:t(1064),alt:""}})]),a._v(" "),e("p",[a._v('Dashboard的websocket工具接收到了Kafka 生产的消息"hello-kafka":')]),a._v(" "),e("p",[e("img",{attrs:{src:t(1065),alt:""}})])])}),[],!1,null,null,null);s.default=r.exports},390:function(a,s,t){a.exports=t.p+"docs-assets/img/modules.89e07c9c.png"}}]);